<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Using the `sparseR` package • sparseR</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Using the `sparseR` package">
<meta property="og:description" content="sparseR">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">sparseR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.1.902</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/sparseR.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/petersonR/sparseR/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="sparseR_files/accessible-code-block-0.0.1/empty-anchor.js"></script><script src="sparseR_files/kePrint-0.0.1/kePrint.js"></script><link href="sparseR_files/lightable-0.0.1/lightable.css" rel="stylesheet">
<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Using the <code>sparseR</code> package</h1>
                        <h4 class="author">Ryan A. Peterson</h4>
            
            <h4 class="date">2021-09-09</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/petersonR/sparseR/blob/master/vignettes/sparseR.Rmd"><code>vignettes/sparseR.Rmd</code></a></small>
      <div class="hidden name"><code>sparseR.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p>The <code>sparseR</code> package aids in the implementation of ranked sparsity methods for model selection in the presence of interactions and polynomials.</p>
<p>The following methods are supported, with help from <code>ncvreg</code> on the backend:</p>
<ol style="list-style-type: decimal">
<li>The sparsity-ranked lasso (SRL)</li>
<li>Sparsity-ranked MCP/SCAD (SRM/SRS)</li>
<li>Sparsity-ranked elastic net (SREN)</li>
</ol>
<p>Additionally, <code>sparseR</code> makes it easy to preprocess data and get it ready for looking at all candidate interactions of order <code>k</code>, or all possible polynomials of order <code>poly</code>.</p>
<p>This document goes through several use cases of the package on different datasets.</p>
</div>
<div id="use-case-iris-data" class="section level1">
<h1 class="hasAnchor">
<a href="#use-case-iris-data" class="anchor"></a>Use case: <code>iris</code> data</h1>
<p>To illustrate in a simple case, consider Fisher’s Iris data set, composed of 4 numeric variables and one categorical variable.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">iris</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">iris</span><span class="op">)</span></code></pre></div>
<pre><code>##   Sepal.Length    Sepal.Width     Petal.Length    Petal.Width   
##  Min.   :4.300   Min.   :2.000   Min.   :1.000   Min.   :0.100  
##  1st Qu.:5.100   1st Qu.:2.800   1st Qu.:1.600   1st Qu.:0.300  
##  Median :5.800   Median :3.000   Median :4.350   Median :1.300  
##  Mean   :5.843   Mean   :3.057   Mean   :3.758   Mean   :1.199  
##  3rd Qu.:6.400   3rd Qu.:3.300   3rd Qu.:5.100   3rd Qu.:1.800  
##  Max.   :7.900   Max.   :4.400   Max.   :6.900   Max.   :2.500  
##        Species  
##  setosa    :50  
##  versicolor:50  
##  virginica :50  
##                 
##                 
## </code></pre>
<p>If we are interested in predicting <code>Sepal.Width</code> based on the other variables and their pairwise interactions, have a couple of options. We can either use the built-in preprocessing for building the model matrix and fitting the model, or we can manually build the model matrix and pass it to the <code>sparseR</code> function.</p>
<div id="using-formula-specification" class="section level2">
<h2 class="hasAnchor">
<a href="#using-formula-specification" class="anchor"></a>Using formula specification</h2>
<p>Passing a <code>formula</code> to <code>sparseR</code> will tell the function which main effects should be in the model. These are also the main effects which will indicate which interactions/polynomials should be investigated. Note that the formula will only accept main effect terms, and will not allow specification of individual interaction effects (or other functions of the main effects).</p>
<p>The sparsity-ranked lasso model for all-pairwise interactions can be fit as follows (cross-validation is performed for <code>lambda</code> via the <code>ncvreg</code> package, so it is important to set the seed for reproducibililty).</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">srl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sparseR.html">sparseR</a></span><span class="op">(</span><span class="va">Sepal.Width</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">iris</span>, k <span class="op">=</span> <span class="fl">1</span>, seed <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></code></pre></div>
<p>The print method will present useful results from these fits:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">srl</span></code></pre></div>
<pre><code>## 
## Model summary @ min CV:
## -----------------------------------------------------
##   lasso-penalized linear regression with n=150, p=18
##   (At lambda=0.0015):
##     Nonzero coefficients: 10
##     Cross-validation error (deviance): 0.07
##     R-squared: 0.62
##     Signal-to-noise ratio: 1.64
##     Scale estimate (sigma): 0.267
## 
##   SR information:
##              Vartype Total Selected Saturation Penalty
##          Main effect     6        4      0.667    2.45
##  Order 1 interaction    12        6      0.500    3.46
## 
## 
## Model summary @ CV1se:
## -----------------------------------------------------
##   lasso-penalized linear regression with n=150, p=18
##   (At lambda=0.0070):
##     Nonzero coefficients: 7
##     Cross-validation error (deviance): 0.08
##     R-squared: 0.57
##     Signal-to-noise ratio: 1.33
##     Scale estimate (sigma): 0.285
## 
##   SR information:
##              Vartype Total Selected Saturation Penalty
##          Main effect     6        3      0.500    2.45
##  Order 1 interaction    12        4      0.333    3.46</code></pre>
<p>For more detailed model information, the <code>summary</code> method for <code>sparseR</code> objects displays more information about the fits (see <code><a href="https://pbreheny.github.io/ncvreg/reference/summary-ncvreg.html">?ncvreg::summary.ncvreg</a></code> for more information).</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># At the lambda which minimizes CVE</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">srl</span>, at <span class="op">=</span> <span class="st">"cvmin"</span><span class="op">)</span></code></pre></div>
<pre><code>## Using a basic kernel estimate for local fdr; consider installing the ashr package for more accurate estimation.  See ?local_mfdr</code></pre>
<pre><code>## lasso-penalized linear regression with n=150, p=18
## At lambda=0.0015:
## -------------------------------------------------
##   Nonzero coefficients         :  10
##   Expected nonzero coefficients:   3.36
##   Average mfdr (10 features)   :   0.336
## 
##                                   Estimate       z       mfdr Selected
## Species_setosa                     1.24843 28.8653    &lt; 1e-04        *
## `Sepal.Length:Species_setosa`      0.35020  9.3864    &lt; 1e-04        *
## Sepal.Length                       0.18424  9.1304    &lt; 1e-04        *
## `Petal.Width:Species_virginica`    0.23716  6.6223    &lt; 1e-04        *
## `Petal.Width:Species_versicolor`   0.55330  4.7733 0.00017238        *
## Species_virginica                 -0.09639 -2.3907 0.27557456        *
## `Sepal.Length:Petal.Length`       -0.04447 -2.2272 0.36889592        *
## `Petal.Length:Petal.Width`         0.04928  2.0135 0.71570426        *
## Petal.Length                      -0.02042 -1.1660 1.00000000        *
## `Sepal.Length:Species_versicolor` -0.01629 -0.5358 1.00000000        *</code></pre>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># At the lambda which is within 1 SE of the minimum CVE</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">srl</span>, at <span class="op">=</span> <span class="st">"cv1se"</span><span class="op">)</span></code></pre></div>
<pre><code>## lasso-penalized linear regression with n=150, p=18
## At lambda=0.0070:
## -------------------------------------------------
##   Nonzero coefficients         :   7
##   Expected nonzero coefficients:   1.38
##   Average mfdr (7 features)    :   0.198
## 
##                                   Estimate       z     mfdr Selected
## Species_setosa                    0.810513 17.9513  &lt; 1e-04        *
## Sepal.Length                      0.191210  9.3371  &lt; 1e-04        *
## `Petal.Length:Petal.Width`        0.119640  5.0379  &lt; 1e-04        *
## `Petal.Width:Species_versicolor`  0.275341  3.1640 0.055680        *
## `Sepal.Length:Petal.Length`      -0.052711 -3.2466 0.078121        *
## `Sepal.Length:Species_setosa`     0.062782  2.5978 0.251076        *
## Species_versicolor               -0.001653 -0.8052 1.000000        *</code></pre>
<p>Finally, plots of either the cross-validation error across <code>lambda</code> values or the coefficient paths can be produced fairly easily:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">srl</span>, plot_type <span class="op">=</span> <span class="st">"cv"</span><span class="op">)</span></code></pre></div>
<p><img src="sparseR_files/figure-html/unnamed-chunk-5-1.png" width="672"></p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">srl</span>, plot_type <span class="op">=</span> <span class="st">"path"</span><span class="op">)</span></code></pre></div>
<p><img src="sparseR_files/figure-html/unnamed-chunk-6-1.png" width="672"></p>
<p>Importantly, since <code>sparseR</code> with a formula centers and scales the covariates prior to forming interactions, the coefficients should be interpreted this way (a 1-unit change in the covariate corresponds to a 1 SD change in the unit of the main effect, and parameters involving interactions must be interpreted at the mean value of involved covariates).</p>
</div>
<div id="using-model-matrix-specification" class="section level2">
<h2 class="hasAnchor">
<a href="#using-model-matrix-specification" class="anchor"></a>Using model matrix specification</h2>
<p>Since the <code>sparseR</code> preprocessing has limits to its customability, and often it will be of interest to create interactions that are centered at prespecified values (as opposed to their mean), it is also possible to feed in a matrix to <code>sparseR</code> that has already been preprocessed. The function also allows users to circumvent the recipes functionality and supply their own model matrix, composed of interactions and/or polynomials. This may be useful in cases where users wish to:</p>
<ul>
<li>specify their own missing data imputation methods,</li>
<li>specify the intercept differently than a grand mean (avoid centering variables prior to making certain interactions of interest)</li>
<li>scale variables differently</li>
</ul>
<p>The key arguments for this purpose are to set <code>pre_process</code> to <code>FALSE</code>, and supply <code>model_matrix</code> and the outcome <code>y</code>. Users may also want to specify how the model matrix is specified in terms of polynomial order (the package requires a prefix, such as “poly_1”, or “poly_2” to denote polynomial terms of orders 1 and 2 respectively) and interaction seperator (by default, this is “\\:”, which is the default for <code>model.matrix</code>).</p>
<p>The code below creates a model matrix will all pairwise interactions, however as opposed to the formula, the numeric variables are not centered prior to forming the interactions, and the factor variable of species will be given a reference category (as opposed to a cell-means specification). Therefore, this method will lead to different results.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/model.matrix.html">model.matrix</a></span><span class="op">(</span><span class="va">Sepal.Width</span> <span class="op">~</span> <span class="va">.</span><span class="op">*</span><span class="va">.</span>, data <span class="op">=</span> <span class="va">iris</span><span class="op">)</span><span class="op">[</span>,<span class="op">-</span><span class="fl">1</span><span class="op">]</span></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>
<span class="va">srl2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sparseR.html">sparseR</a></span><span class="op">(</span>pre_process <span class="op">=</span> <span class="cn">FALSE</span>, model_matrix <span class="op">=</span> <span class="va">X</span>, y <span class="op">=</span> <span class="va">iris</span><span class="op">$</span><span class="va">Sepal.Width</span><span class="op">)</span></code></pre></div>
<pre><code>## Warning in ncvreg(X = X, y = y, ...): Maximum number of iterations reached</code></pre>
<p>Since we have a warning about iterations, note that we can pass through arguments to <code>ncvreg</code> and fix this issue:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>
<span class="va">srl2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sparseR.html">sparseR</a></span><span class="op">(</span>pre_process <span class="op">=</span> <span class="cn">FALSE</span>, model_matrix <span class="op">=</span> <span class="va">X</span>, y <span class="op">=</span> <span class="va">iris</span><span class="op">$</span><span class="va">Sepal.Width</span>, max.iter <span class="op">=</span> <span class="fl">1e6</span><span class="op">)</span></code></pre></div>
<p>And we can use the same S3 methods to get more information about the SRL model:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">srl2</span></code></pre></div>
<pre><code>## 
## Model summary @ min CV:
## -----------------------------------------------------
##   lasso-penalized linear regression with n=150, p=14
##   (At lambda=0.0005):
##     Nonzero coefficients: 8
##     Cross-validation error (deviance): 0.07
##     R-squared: 0.64
##     Signal-to-noise ratio: 1.77
##     Scale estimate (sigma): 0.261
## 
##   SR information:
##              Vartype Total Selected Saturation Penalty
##          Main effect     5        3      0.600    2.24
##  Order 1 interaction     9        5      0.556    3.00
## 
## 
## Model summary @ CV1se:
## -----------------------------------------------------
##   lasso-penalized linear regression with n=150, p=14
##   (At lambda=0.0021):
##     Nonzero coefficients: 5
##     Cross-validation error (deviance): 0.08
##     R-squared: 0.59
##     Signal-to-noise ratio: 1.46
##     Scale estimate (sigma): 0.277
## 
##   SR information:
##              Vartype Total Selected Saturation Penalty
##          Main effect     5        4      0.800    2.24
##  Order 1 interaction     9        1      0.111    3.00</code></pre>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">srl2</span>, at <span class="op">=</span> <span class="st">"cv1se"</span><span class="op">)</span></code></pre></div>
<pre><code>## lasso-penalized linear regression with n=150, p=14
## At lambda=0.0021:
## -------------------------------------------------
##   Nonzero coefficients         :   5
##   Expected nonzero coefficients:   0.00
##   Average mfdr (5 features)    :   0.000
## 
##                             Estimate      z    mfdr Selected
## Speciesvirginica             -1.1502 -25.15 &lt; 1e-04        *
## Speciesversicolor            -1.0558 -23.10 &lt; 1e-04        *
## Sepal.Length                  0.4243  16.32 &lt; 1e-04        *
## Petal.Width                   0.3390  12.06 &lt; 1e-04        *
## `Sepal.Length:Petal.Length`  -0.0189 -11.68 &lt; 1e-04        *</code></pre>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">srl2</span><span class="op">)</span></code></pre></div>
<p><img src="sparseR_files/figure-html/unnamed-chunk-10-1.png" width="672"></p>
<p>Since we did not center/scale any of the variables prior to this fitting procedure, the interpretation of these coefficients should be on the original scale of the predictors, and the origin for the terms involved in interactions is 0, not at the mean of their constituent covariates.</p>
<p>Note also that there are fewer total covariates listed. This is because <code>model.matrix</code> uses reference cell dummy variables by default. Another way to do this without the reference category specification would be to pass pre-process options to <code>sparseR</code>, or to manually use <code>sparseR_prep</code> to create the model matrix.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span> 
<span class="va">srl3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sparseR.html">sparseR</a></span><span class="op">(</span><span class="va">Sepal.Width</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">iris</span>, k <span class="op">=</span> <span class="fl">1</span>, 
                pre_proc_opts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"none"</span><span class="op">)</span>, max.iter <span class="op">=</span> <span class="fl">1e6</span><span class="op">)</span>
<span class="va">srl3</span></code></pre></div>
<pre><code>## 
## Model summary @ min CV:
## -----------------------------------------------------
##   lasso-penalized linear regression with n=150, p=18
##   (At lambda=0.0006):
##     Nonzero coefficients: 6
##     Cross-validation error (deviance): 0.07
##     R-squared: 0.64
##     Signal-to-noise ratio: 1.79
##     Scale estimate (sigma): 0.260
## 
##   SR information:
##              Vartype Total Selected Saturation Penalty
##          Main effect     6        2      0.333    2.45
##  Order 1 interaction    12        4      0.333    3.46
## 
## 
## Model summary @ CV1se:
## -----------------------------------------------------
##   lasso-penalized linear regression with n=150, p=18
##   (At lambda=0.0043):
##     Nonzero coefficients: 5
##     Cross-validation error (deviance): 0.08
##     R-squared: 0.59
##     Signal-to-noise ratio: 1.46
##     Scale estimate (sigma): 0.277
## 
##   SR information:
##              Vartype Total Selected Saturation Penalty
##          Main effect     6        3      0.500    2.45
##  Order 1 interaction    12        2      0.167    3.46</code></pre>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">srl3</span>, at <span class="op">=</span> <span class="st">"cv1se"</span><span class="op">)</span></code></pre></div>
<pre><code>## lasso-penalized linear regression with n=150, p=18
## At lambda=0.0043:
## -------------------------------------------------
##   Nonzero coefficients         :   5
##   Expected nonzero coefficients:   2.00
##   Average mfdr (5 features)    :   0.400
## 
##                               Estimate       z   mfdr Selected
## `Sepal.Length:Species_setosa`  0.20458 22.6156 &lt;1e-04        *
## Sepal.Length                   0.23392  9.2194 &lt;1e-04        *
## Petal.Width                    0.15373  5.7679 &lt;1e-04        *
## Species_virginica             -0.03911 -1.3126      1        *
## `Petal.Width:Species_setosa`   0.02738  0.8386      1        *</code></pre>
</div>
<div id="centering-to-different-values" class="section level2">
<h2 class="hasAnchor">
<a href="#centering-to-different-values" class="anchor"></a>Centering to different values</h2>
<p>In many cases with interactions, it makes sense to center variables to certain values (or rather, it does <strong>not</strong> make sense to center variables to their mean or to zero). Therefore we built some flexibility into <code>sparseR</code> and <code>sparseR_prep</code> in order to allow users to change these as the context dictates.</p>
<p>Each covariate’s centering location (in this case their minima) can be passed into <code>sparseR_prep</code> as follows:</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">cc</span> <span class="op">&lt;-</span> <span class="va">iris</span> <span class="op">%&gt;%</span>
    <span class="fu">select</span><span class="op">(</span><span class="va">Sepal.Length</span>, <span class="va">Petal.Length</span>, <span class="va">Petal.Width</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="fl">2</span>, <span class="va">min</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>


<span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sparseR_prep.html">sparseR_prep</a></span><span class="op">(</span><span class="va">Sepal.Width</span> <span class="op">~</span> <span class="va">.</span>, <span class="va">iris</span>, k <span class="op">=</span> <span class="fl">0</span>, extra_opts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>centers <span class="op">=</span> <span class="va">cc</span><span class="op">)</span><span class="op">)</span>
<span class="op">(</span><span class="va">c2min</span> <span class="op">&lt;-</span> <span class="fu">bake</span><span class="op">(</span><span class="va">p1</span>, <span class="va">iris</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## # A tibble: 150 × 6
##    Sepal.Length Petal.Length Petal.Width Species_setosa Species_versicolor
##           &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt;          &lt;dbl&gt;              &lt;dbl&gt;
##  1        0.966        0.227       0.131              1                  0
##  2        0.725        0.227       0.131              1                  0
##  3        0.483        0.170       0.131              1                  0
##  4        0.362        0.283       0.131              1                  0
##  5        0.845        0.227       0.131              1                  0
##  6        1.33         0.397       0.394              1                  0
##  7        0.362        0.227       0.262              1                  0
##  8        0.845        0.283       0.131              1                  0
##  9        0.121        0.227       0.131              1                  0
## 10        0.725        0.283       0                  1                  0
## # … with 140 more rows, and 1 more variable: Species_virginica &lt;dbl&gt;</code></pre>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">c2min</span><span class="op">)</span></code></pre></div>
<pre><code>##   Sepal.Length     Petal.Length     Petal.Width     Species_setosa  
##  Min.   :0.0000   Min.   :0.0000   Min.   :0.0000   Min.   :0.0000  
##  1st Qu.:0.9661   1st Qu.:0.3399   1st Qu.:0.2624   1st Qu.:0.0000  
##  Median :1.8115   Median :1.8977   Median :1.5743   Median :0.0000  
##  Mean   :1.8638   Mean   :1.5623   Mean   :1.4422   Mean   :0.3333  
##  3rd Qu.:2.5360   3rd Qu.:2.3226   3rd Qu.:2.2303   3rd Qu.:1.0000  
##  Max.   :4.3475   Max.   :3.3422   Max.   :3.1486   Max.   :1.0000  
##  Species_versicolor Species_virginica
##  Min.   :0.0000     Min.   :0.0000   
##  1st Qu.:0.0000     1st Qu.:0.0000   
##  Median :0.0000     Median :0.0000   
##  Mean   :0.3333     Mean   :0.3333   
##  3rd Qu.:1.0000     3rd Qu.:1.0000   
##  Max.   :1.0000     Max.   :1.0000</code></pre>
<p>Or directly into <code>sparseR</code>:</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">srl_centered2min</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sparseR.html">sparseR</a></span><span class="op">(</span><span class="va">Sepal.Width</span> <span class="op">~</span> <span class="va">.</span>, <span class="va">iris</span>, extra_opts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>centers <span class="op">=</span> <span class="va">cc</span><span class="op">)</span>, seed <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></code></pre></div>
<p>Or, a function can be passed to evaluate the location for each covariate:</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sparseR_prep.html">sparseR_prep</a></span><span class="op">(</span><span class="va">Sepal.Width</span> <span class="op">~</span> <span class="va">.</span>, <span class="va">iris</span>, k <span class="op">=</span> <span class="fl">0</span>, extra_opts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>center_fn <span class="op">=</span> <span class="va">min</span><span class="op">)</span><span class="op">)</span>
<span class="op">(</span><span class="va">c2min2</span> <span class="op">&lt;-</span> <span class="fu">bake</span><span class="op">(</span><span class="va">p2</span>, <span class="va">iris</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## # A tibble: 150 × 6
##    Sepal.Length Petal.Length Petal.Width Species_setosa Species_versicolor
##           &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt;          &lt;dbl&gt;              &lt;dbl&gt;
##  1        0.966        0.227       0.131              1                  0
##  2        0.725        0.227       0.131              1                  0
##  3        0.483        0.170       0.131              1                  0
##  4        0.362        0.283       0.131              1                  0
##  5        0.845        0.227       0.131              1                  0
##  6        1.33         0.397       0.394              1                  0
##  7        0.362        0.227       0.262              1                  0
##  8        0.845        0.283       0.131              1                  0
##  9        0.121        0.227       0.131              1                  0
## 10        0.725        0.283       0                  1                  0
## # … with 140 more rows, and 1 more variable: Species_virginica &lt;dbl&gt;</code></pre>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/identical.html">identical</a></span><span class="op">(</span><span class="va">c2min2</span>, <span class="va">c2min</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
</div>
<div id="plotting-the-model" class="section level2">
<h2 class="hasAnchor">
<a href="#plotting-the-model" class="anchor"></a>Plotting the model</h2>
<p>Interactions are notoriously difficult to understand and to communicate, and visualizations can often be helpful. The <code>sparseR</code> package has some limited functionality for plotting the results from these fits, using the <code>visreg</code> package as a rough guide.</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/effect_plot.html">effect_plot</a></span><span class="op">(</span><span class="va">srl</span>, <span class="st">"Petal.Width"</span>, by <span class="op">=</span> <span class="st">"Species"</span><span class="op">)</span></code></pre></div>
<p><img src="sparseR_files/figure-html/unnamed-chunk-15-1.png" width="672"></p>
<p>Notice how this changes if the covariates are centered to their minima instead:</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/effect_plot.html">effect_plot</a></span><span class="op">(</span><span class="va">srl_centered2min</span>, <span class="st">"Petal.Width"</span>, by <span class="op">=</span> <span class="st">"Species"</span><span class="op">)</span></code></pre></div>
<p><img src="sparseR_files/figure-html/unnamed-chunk-16-1.png" width="672"></p>
<p>It’s clear that the model itself can change quite a bit depending on the center location utilized prior to building the interactions. Unfortunately, optimizing the center location for each covariate is a difficult, p-dimensional problem (set in the context of another difficult optimization problem of regularized regression with multiple tuning parameters).</p>
<p>The <code>sparseR</code> package will allow users to compare certain choices in terms of their cross-validated error, which is a decent starting point. The plot below shows how the “centered to zero” model has <em>slightly</em> lower cross-validated error than the best mean-centered model and the best minimum-centered model.</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span>, mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">4</span>,<span class="fl">5</span>,<span class="fl">2</span><span class="op">)</span> <span class="op">+</span> <span class="fl">.1</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">srl3</span>, plot_type <span class="op">=</span> <span class="st">"cv"</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">.2</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/title.html">title</a></span><span class="op">(</span><span class="st">"Centered to zero"</span>, line <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">srl3</span><span class="op">$</span><span class="va">fit</span><span class="op">$</span><span class="va">cve</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">srl_centered2min</span>, plot_type <span class="op">=</span> <span class="st">"cv"</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">.2</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/title.html">title</a></span><span class="op">(</span><span class="st">"Centered to minimum values"</span>, line <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">srl3</span><span class="op">$</span><span class="va">fit</span><span class="op">$</span><span class="va">cve</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">srl</span>, plot_type <span class="op">=</span> <span class="st">"cv"</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">.2</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/title.html">title</a></span><span class="op">(</span><span class="st">"Centered to mean"</span>, line <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">srl3</span><span class="op">$</span><span class="va">fit</span><span class="op">$</span><span class="va">cve</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">4</span>,<span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span> <span class="op">+</span><span class="fl">.1</span><span class="op">)</span>
<span class="fu"><a href="../reference/effect_plot.html">effect_plot</a></span><span class="op">(</span><span class="va">srl3</span>, <span class="st">"Petal.Width"</span>, by <span class="op">=</span> <span class="st">"Species"</span>, 
            plot.args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1.5</span>, <span class="fl">4.8</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="../reference/effect_plot.html">effect_plot</a></span><span class="op">(</span><span class="va">srl_centered2min</span>, <span class="st">"Petal.Width"</span>, by <span class="op">=</span> <span class="st">"Species"</span>, 
            plot.args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1.5</span>, <span class="fl">4.8</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="../reference/effect_plot.html">effect_plot</a></span><span class="op">(</span><span class="va">srl</span>, <span class="st">"Petal.Width"</span>, by <span class="op">=</span> <span class="st">"Species"</span>, 
            plot.args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1.5</span>, <span class="fl">4.8</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="sparseR_files/figure-html/unnamed-chunk-17-1.png" width="100%"></p>
<p>Though these models look substantially different, it’s worth noting that the predictions obtained from the three models are very close to one another (since the models look similar in the neighborhood of existing data):</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">srl3</span>, at <span class="op">=</span> <span class="st">"cvmin"</span><span class="op">)</span>
<span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">srl_centered2min</span>, at <span class="op">=</span> <span class="st">"cvmin"</span><span class="op">)</span>
<span class="va">p3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">srl</span>, at <span class="op">=</span> <span class="st">"cvmin"</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">p1</span>, <span class="va">p2</span> ,<span class="va">p3</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>##           p1        p2        p3
## p1 1.0000000 0.9917599 0.9921750
## p2 0.9917599 1.0000000 0.9946687
## p3 0.9921750 0.9946687 1.0000000</code></pre>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/pairs.html">pairs</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">p1</span>, <span class="va">p2</span> ,<span class="va">p3</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="sparseR_files/figure-html/unnamed-chunk-18-1.png" width="672"></p>
<p>At the CV1se lambda value, there is slightly less agreement in these predictions:</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># At CV1se</span>
<span class="va">p4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">srl3</span>, at <span class="op">=</span> <span class="st">"cv1se"</span><span class="op">)</span>
<span class="va">p5</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">srl_centered2min</span>, at <span class="op">=</span> <span class="st">"cv1se"</span><span class="op">)</span>
<span class="va">p6</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">srl</span>, at <span class="op">=</span> <span class="st">"cv1se"</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">p1</span>, <span class="va">p2</span> ,<span class="va">p3</span>, <span class="va">p4</span>,<span class="va">p5</span>,<span class="va">p6</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>##           p1        p2        p3        p4        p5        p6
## p1 1.0000000 0.9917599 0.9921750 0.9711085 0.9595865 0.9732816
## p2 0.9917599 1.0000000 0.9946687 0.9692262 0.9797246 0.9642979
## p3 0.9921750 0.9946687 1.0000000 0.9677262 0.9701393 0.9763341
## p4 0.9711085 0.9692262 0.9677262 1.0000000 0.9789632 0.9882960
## p5 0.9595865 0.9797246 0.9701393 0.9789632 1.0000000 0.9602063
## p6 0.9732816 0.9642979 0.9763341 0.9882960 0.9602063 1.0000000</code></pre>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/pairs.html">pairs</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">p1</span>, <span class="va">p2</span> ,<span class="va">p3</span>, <span class="va">p4</span>,<span class="va">p5</span>,<span class="va">p6</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="sparseR_files/figure-html/unnamed-chunk-19-1.png" width="672"></p>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="../reference/effect_plot.html">effect_plot</a></span><span class="op">(</span><span class="va">srl3</span>, <span class="st">"Petal.Width"</span>, by <span class="op">=</span> <span class="st">"Species"</span>, at <span class="op">=</span> <span class="st">"cv1se"</span>, 
            plot.args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1.5</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="../reference/effect_plot.html">effect_plot</a></span><span class="op">(</span><span class="va">srl_centered2min</span>, <span class="st">"Petal.Width"</span>, by <span class="op">=</span> <span class="st">"Species"</span>, at <span class="op">=</span> <span class="st">"cv1se"</span>, 
            plot.args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1.5</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="../reference/effect_plot.html">effect_plot</a></span><span class="op">(</span><span class="va">srl</span>, <span class="st">"Petal.Width"</span>, by <span class="op">=</span> <span class="st">"Species"</span>, at <span class="op">=</span> <span class="st">"cv1se"</span>, 
            plot.args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1.5</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="sparseR_files/figure-html/unnamed-chunk-20-1.png" width="672"></p>
</div>
<div id="using-stepwise-rbic" class="section level2">
<h2 class="hasAnchor">
<a href="#using-stepwise-rbic" class="anchor"></a>Using stepwise RBIC</h2>
<p>RBIC, or <em>Ranked-sparsity Bayesian Information Criterion</em>, is a ranked sparsity model selection criterion that will correctly penalize interactions (higher than main effects). The benefit of using a stepwise approach informed by RBIC is that there is no shrinkage, and it thus doesn’t matter whether or not (or where) the covariates are centered (usually). The exceptions here occur when the stepwise process is not sequential/hierarchical (i.e. main effects first, then interactions of the “active” main effects, etc.).</p>
<p>Inference on the parameters is still i) difficult because one must account for post-selection inference, and ii) affected by where and whether the covariates are centered. However, the lines themselves will not be affected by centering status.</p>
<p>We can see this in the examples below:</p>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Centered model</span>
<span class="op">(</span><span class="va">rbic1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sparseRBIC_step.html">sparseRBIC_step</a></span><span class="op">(</span><span class="va">Sepal.Width</span> <span class="op">~</span> <span class="va">.</span>, <span class="va">iris</span>, pre_proc_opts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"center"</span>, <span class="st">"scale"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## 
## Call:  glm(formula = y ~ Species_setosa + Sepal.Length + Petal.Width + 
##     Species_versicolor + Petal.Length + `Sepal.Length:Species_setosa`, 
##     family = family, data = X)
## 
## Coefficients:
##                   (Intercept)                 Species_setosa  
##                       2.40062                        2.14130  
##                  Sepal.Length                    Petal.Width  
##                       0.16506                        0.44726  
##            Species_versicolor                   Petal.Length  
##                       0.29340                       -0.05916  
## `Sepal.Length:Species_setosa`  
##                       0.45943  
## 
## Degrees of Freedom: 149 Total (i.e. Null);  143 Residual
## Null Deviance:       28.31 
## Residual Deviance: 8.999     AIC: 19.65</code></pre>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Non-centered model</span>
<span class="op">(</span><span class="va">rbic2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sparseRBIC_step.html">sparseRBIC_step</a></span><span class="op">(</span><span class="va">Sepal.Width</span> <span class="op">~</span> <span class="va">.</span>, <span class="va">iris</span>, pre_proc_opts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"scale"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## 
## Call:  glm(formula = y ~ Species_setosa + Sepal.Length + Petal.Width + 
##     Species_versicolor + Petal.Length + `Sepal.Length:Species_setosa`, 
##     family = family, data = X)
## 
## Coefficients:
##                   (Intercept)                 Species_setosa  
##                       0.65809                       -1.10073  
##                  Sepal.Length                    Petal.Width  
##                       0.16506                        0.44726  
##            Species_versicolor                   Petal.Length  
##                       0.29340                       -0.05916  
## `Sepal.Length:Species_setosa`  
##                       0.45943  
## 
## Degrees of Freedom: 149 Total (i.e. Null);  143 Residual
## Null Deviance:       28.31 
## Residual Deviance: 8.999     AIC: 19.65</code></pre>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="../reference/effect_plot.html">effect_plot</a></span><span class="op">(</span><span class="va">rbic1</span>, <span class="st">"Petal.Width"</span>, by <span class="op">=</span> <span class="st">"Species"</span>, plot.args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1.5</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="../reference/effect_plot.html">effect_plot</a></span><span class="op">(</span><span class="va">rbic2</span>, <span class="st">"Petal.Width"</span>, by <span class="op">=</span> <span class="st">"Species"</span>, plot.args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1.5</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="../reference/effect_plot.html">effect_plot</a></span><span class="op">(</span><span class="va">rbic1</span>, <span class="st">"Sepal.Length"</span>, by <span class="op">=</span> <span class="st">"Species"</span><span class="op">)</span>
<span class="fu"><a href="../reference/effect_plot.html">effect_plot</a></span><span class="op">(</span><span class="va">rbic2</span>, <span class="st">"Sepal.Length"</span>, by <span class="op">=</span> <span class="st">"Species"</span><span class="op">)</span></code></pre></div>
<p><img src="sparseR_files/figure-html/unnamed-chunk-21-1.png" width="576"></p>
<p>Again similar S3 methods are available (note how inference does change for certain parameters based on the centering status). A message is produced because these p-values do not account for post-selection inference.</p>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">rbic1</span><span class="op">)</span></code></pre></div>
<pre><code>## P-values have **not** been corrected for multiple comparisons
## Consider sparseRBIC_sampsplit() or sparseRBIC_bootstrap()</code></pre>
<pre><code>## 
## Call:
## glm(formula = y ~ Species_setosa + Sepal.Length + Petal.Width + 
##     Species_versicolor + Petal.Length + `Sepal.Length:Species_setosa`, 
##     family = family, data = X)
## 
## Deviance Residuals: 
##      Min        1Q    Median        3Q       Max  
## -0.78351  -0.15819   0.01874   0.16809   0.61264  
## 
## Coefficients:
##                               Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)                    2.40062    0.12025  19.964  &lt; 2e-16 ***
## Species_setosa                 2.14130    0.30584   7.001 9.10e-11 ***
## Sepal.Length                   0.16506    0.06017   2.743  0.00687 ** 
## Petal.Width                    0.44726    0.08833   5.064 1.25e-06 ***
## Species_versicolor             0.29340    0.09839   2.982  0.00337 ** 
## Petal.Length                  -0.05916    0.15021  -0.394  0.69428    
## `Sepal.Length:Species_setosa`  0.45943    0.09997   4.596 9.40e-06 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## (Dispersion parameter for gaussian family taken to be 0.06292687)
## 
##     Null deviance: 28.3069  on 149  degrees of freedom
## Residual deviance:  8.9985  on 143  degrees of freedom
## AIC: 19.646
## 
## Number of Fisher Scoring iterations: 2</code></pre>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">rbic2</span><span class="op">)</span></code></pre></div>
<pre><code>## P-values have **not** been corrected for multiple comparisons
## Consider sparseRBIC_sampsplit() or sparseRBIC_bootstrap()</code></pre>
<pre><code>## 
## Call:
## glm(formula = y ~ Species_setosa + Sepal.Length + Petal.Width + 
##     Species_versicolor + Petal.Length + `Sepal.Length:Species_setosa`, 
##     family = family, data = X)
## 
## Deviance Residuals: 
##      Min        1Q    Median        3Q       Max  
## -0.78351  -0.15819   0.01874   0.16809   0.61264  
## 
## Coefficients:
##                               Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)                    0.65809    0.31114   2.115  0.03616 *  
## Species_setosa                -1.10073    0.60258  -1.827  0.06983 .  
## Sepal.Length                   0.16506    0.06017   2.743  0.00687 ** 
## Petal.Width                    0.44726    0.08833   5.064 1.25e-06 ***
## Species_versicolor             0.29340    0.09839   2.982  0.00337 ** 
## Petal.Length                  -0.05916    0.15021  -0.394  0.69428    
## `Sepal.Length:Species_setosa`  0.45943    0.09997   4.596 9.40e-06 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## (Dispersion parameter for gaussian family taken to be 0.06292687)
## 
##     Null deviance: 28.3069  on 149  degrees of freedom
## Residual deviance:  8.9985  on 143  degrees of freedom
## AIC: 19.646
## 
## Number of Fisher Scoring iterations: 2</code></pre>
<p>Alternatively, sample splitting can be utilized to achieve valid inference. This method divides the data into two samples of equal size, uses the first sample to select the model, and the second one to fit and achieve valid (though potentially low-power) inference. Coefficients which are not selected are bestowed a p-value of 1.</p>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">s1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sparseRBIC_sampsplit.html">sparseRBIC_sampsplit</a></span><span class="op">(</span><span class="va">rbic1</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">s1</span><span class="op">$</span><span class="va">results</span> <span class="op">%&gt;%</span>
  <span class="fu">kable</span><span class="op">(</span>digits <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">kable_styling</span><span class="op">(</span>full_width <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<table class="table table">
<thead><tr>
<th style="text-align:left;">
Coefficient
</th>
<th style="text-align:right;">
Median_p
</th>
<th style="text-align:right;">
Mean_p
</th>
<th style="text-align:right;">
Gmean_p
</th>
<th style="text-align:right;">
% selected
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
(Intercept)
</td>
<td style="text-align:right;">
0.00000
</td>
<td style="text-align:right;">
0.00000
</td>
<td style="text-align:right;">
0.00000
</td>
<td style="text-align:right;">
100
</td>
</tr>
<tr>
<td style="text-align:left;">
Species_setosa
</td>
<td style="text-align:right;">
0.00000
</td>
<td style="text-align:right;">
0.00632
</td>
<td style="text-align:right;">
0.00000
</td>
<td style="text-align:right;">
100
</td>
</tr>
<tr>
<td style="text-align:left;">
Sepal.Length
</td>
<td style="text-align:right;">
0.00010
</td>
<td style="text-align:right;">
0.03286
</td>
<td style="text-align:right;">
0.00010
</td>
<td style="text-align:right;">
99
</td>
</tr>
<tr>
<td style="text-align:left;">
Petal.Width
</td>
<td style="text-align:right;">
1.00000
</td>
<td style="text-align:right;">
0.52173
</td>
<td style="text-align:right;">
0.07946
</td>
<td style="text-align:right;">
49
</td>
</tr>
<tr>
<td style="text-align:left;">
Species_versicolor
</td>
<td style="text-align:right;">
1.00000
</td>
<td style="text-align:right;">
0.82359
</td>
<td style="text-align:right;">
0.51189
</td>
<td style="text-align:right;">
19
</td>
</tr>
<tr>
<td style="text-align:left;">
Sepal.Length:Species_setosa
</td>
<td style="text-align:right;">
0.00529
</td>
<td style="text-align:right;">
0.23679
</td>
<td style="text-align:right;">
0.00737
</td>
<td style="text-align:right;">
77
</td>
</tr>
<tr>
<td style="text-align:left;">
Species_virginica
</td>
<td style="text-align:right;">
1.00000
</td>
<td style="text-align:right;">
0.88884
</td>
<td style="text-align:right;">
0.66978
</td>
<td style="text-align:right;">
12
</td>
</tr>
<tr>
<td style="text-align:left;">
Petal.Length
</td>
<td style="text-align:right;">
1.00000
</td>
<td style="text-align:right;">
0.85029
</td>
<td style="text-align:right;">
0.64690
</td>
<td style="text-align:right;">
20
</td>
</tr>
<tr>
<td style="text-align:left;">
Petal.Length:Petal.Width
</td>
<td style="text-align:right;">
1.00000
</td>
<td style="text-align:right;">
0.99395
</td>
<td style="text-align:right;">
0.99075
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
Petal.Width:Species_setosa
</td>
<td style="text-align:right;">
1.00000
</td>
<td style="text-align:right;">
0.98221
</td>
<td style="text-align:right;">
0.97050
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:left;">
Sepal.Length:Petal.Width
</td>
<td style="text-align:right;">
1.00000
</td>
<td style="text-align:right;">
0.92072
</td>
<td style="text-align:right;">
0.67022
</td>
<td style="text-align:right;">
8
</td>
</tr>
<tr>
<td style="text-align:left;">
Petal.Width:Species_versicolor
</td>
<td style="text-align:right;">
1.00000
</td>
<td style="text-align:right;">
0.99695
</td>
<td style="text-align:right;">
0.99637
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
Sepal.Length:Species_versicolor
</td>
<td style="text-align:right;">
1.00000
</td>
<td style="text-align:right;">
0.99669
</td>
<td style="text-align:right;">
0.99608
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
Sepal.Length:Petal.Length
</td>
<td style="text-align:right;">
1.00000
</td>
<td style="text-align:right;">
0.96317
</td>
<td style="text-align:right;">
0.85959
</td>
<td style="text-align:right;">
4
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">s2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sparseRBIC_sampsplit.html">sparseRBIC_sampsplit</a></span><span class="op">(</span><span class="va">rbic2</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">s2</span><span class="op">$</span><span class="va">results</span> <span class="op">%&gt;%</span>
  <span class="fu">kable</span><span class="op">(</span>digits <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">kable_styling</span><span class="op">(</span>full_width <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<table class="table table">
<thead><tr>
<th style="text-align:left;">
Coefficient
</th>
<th style="text-align:right;">
Median_p
</th>
<th style="text-align:right;">
Mean_p
</th>
<th style="text-align:right;">
Gmean_p
</th>
<th style="text-align:right;">
% selected
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
(Intercept)
</td>
<td style="text-align:right;">
0.00500
</td>
<td style="text-align:right;">
0.07581
</td>
<td style="text-align:right;">
0.00413
</td>
<td style="text-align:right;">
100
</td>
</tr>
<tr>
<td style="text-align:left;">
Species_setosa
</td>
<td style="text-align:right;">
0.07861
</td>
<td style="text-align:right;">
0.13584
</td>
<td style="text-align:right;">
0.00588
</td>
<td style="text-align:right;">
100
</td>
</tr>
<tr>
<td style="text-align:left;">
Sepal.Length
</td>
<td style="text-align:right;">
0.00002
</td>
<td style="text-align:right;">
0.03906
</td>
<td style="text-align:right;">
0.00003
</td>
<td style="text-align:right;">
97
</td>
</tr>
<tr>
<td style="text-align:left;">
Petal.Width
</td>
<td style="text-align:right;">
1.00000
</td>
<td style="text-align:right;">
0.73882
</td>
<td style="text-align:right;">
0.27036
</td>
<td style="text-align:right;">
27
</td>
</tr>
<tr>
<td style="text-align:left;">
Species_versicolor
</td>
<td style="text-align:right;">
1.00000
</td>
<td style="text-align:right;">
0.87126
</td>
<td style="text-align:right;">
0.63427
</td>
<td style="text-align:right;">
14
</td>
</tr>
<tr>
<td style="text-align:left;">
Sepal.Length:Species_setosa
</td>
<td style="text-align:right;">
0.00828
</td>
<td style="text-align:right;">
0.14857
</td>
<td style="text-align:right;">
0.00667
</td>
<td style="text-align:right;">
87
</td>
</tr>
<tr>
<td style="text-align:left;">
Petal.Length
</td>
<td style="text-align:right;">
1.00000
</td>
<td style="text-align:right;">
0.95611
</td>
<td style="text-align:right;">
0.89616
</td>
<td style="text-align:right;">
8
</td>
</tr>
<tr>
<td style="text-align:left;">
Sepal.Length:Petal.Length
</td>
<td style="text-align:right;">
1.00000
</td>
<td style="text-align:right;">
0.97590
</td>
<td style="text-align:right;">
0.92221
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:left;">
Species_virginica
</td>
<td style="text-align:right;">
1.00000
</td>
<td style="text-align:right;">
0.94887
</td>
<td style="text-align:right;">
0.84585
</td>
<td style="text-align:right;">
6
</td>
</tr>
<tr>
<td style="text-align:left;">
Petal.Width:Species_setosa
</td>
<td style="text-align:right;">
1.00000
</td>
<td style="text-align:right;">
0.99869
</td>
<td style="text-align:right;">
0.99860
</td>
<td style="text-align:right;">
1
</td>
</tr>
</tbody>
</table>
<p>Additionally, inferences based on bootstrapped samples of the data are available via the <code>sparseRBIC_bootstrap</code> function, which stores p-values for each coefficient after model selection has been performed. If a coefficient has not been selected, the p-value is set to one for that bootstrap iteration, so when the “mean” p-value is calculated across bootstraps, the underestimation of the p-value due to model selection is attenuated, as the estimate gets “pulled up” by the 1’s in the vector. Since this may be a conservative approach, we also display the “geometric” mean which is a measure of central tendency less sensitive to skew (which many p-values will be highly right skewed). More research must be done on these techniques to ensure adequate coverage properties, but given a high enough number of bootstrap samples they should both be more conservative than the naive, “pretend model selection never took place” approach. The downside here is that depending on the size of the data and the number of variables, this could take quite some time.</p>
<p>Note that the mean p-value across bootstraps is bounded to be greater than 1-P(selected). In some sense, this makes sense, as if a variable has a low probability of being selected, then that variable should have a higher adjusted p-value. However, for variables whose effects will be highly related (i.e. an interaction and a constituent main effect), this may be too conservative.</p>
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>
<span class="co">## Centered model</span>
<span class="va">b1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sparseRBIC_bootstrap.html">sparseRBIC_bootstrap</a></span><span class="op">(</span><span class="va">rbic1</span>, B <span class="op">=</span> <span class="fl">250</span><span class="op">)</span></code></pre></div>
<table class="table table">
<thead><tr>
<th style="text-align:left;">
Coefficient
</th>
<th style="text-align:right;">
Mean_p
</th>
<th style="text-align:right;">
Gmean_p
</th>
<th style="text-align:right;">
% selected
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
(Intercept)
</td>
<td style="text-align:right;">
0.00000
</td>
<td style="text-align:right;">
0.00000
</td>
<td style="text-align:right;">
100.0
</td>
</tr>
<tr>
<td style="text-align:left;">
Species_setosa
</td>
<td style="text-align:right;">
0.00978
</td>
<td style="text-align:right;">
0.00000
</td>
<td style="text-align:right;">
100.0
</td>
</tr>
<tr>
<td style="text-align:left;">
Sepal.Length
</td>
<td style="text-align:right;">
0.00444
</td>
<td style="text-align:right;">
0.00000
</td>
<td style="text-align:right;">
100.0
</td>
</tr>
<tr>
<td style="text-align:left;">
Sepal.Length:Species_setosa
</td>
<td style="text-align:right;">
0.25235
</td>
<td style="text-align:right;">
0.00007
</td>
<td style="text-align:right;">
74.8
</td>
</tr>
<tr>
<td style="text-align:left;">
Petal.Width
</td>
<td style="text-align:right;">
0.33706
</td>
<td style="text-align:right;">
0.00004
</td>
<td style="text-align:right;">
66.4
</td>
</tr>
<tr>
<td style="text-align:left;">
Species_virginica
</td>
<td style="text-align:right;">
0.95211
</td>
<td style="text-align:right;">
0.66018
</td>
<td style="text-align:right;">
4.8
</td>
</tr>
<tr>
<td style="text-align:left;">
Petal.Length
</td>
<td style="text-align:right;">
0.71850
</td>
<td style="text-align:right;">
0.36074
</td>
<td style="text-align:right;">
35.6
</td>
</tr>
<tr>
<td style="text-align:left;">
Species_versicolor
</td>
<td style="text-align:right;">
0.63447
</td>
<td style="text-align:right;">
0.04241
</td>
<td style="text-align:right;">
40.0
</td>
</tr>
<tr>
<td style="text-align:left;">
Sepal.Length:Petal.Width
</td>
<td style="text-align:right;">
0.86832
</td>
<td style="text-align:right;">
0.22093
</td>
<td style="text-align:right;">
13.2
</td>
</tr>
<tr>
<td style="text-align:left;">
Sepal.Length:Species_versicolor
</td>
<td style="text-align:right;">
0.97231
</td>
<td style="text-align:right;">
0.86439
</td>
<td style="text-align:right;">
2.8
</td>
</tr>
<tr>
<td style="text-align:left;">
Petal.Width:Species_setosa
</td>
<td style="text-align:right;">
0.92488
</td>
<td style="text-align:right;">
0.68161
</td>
<td style="text-align:right;">
7.6
</td>
</tr>
<tr>
<td style="text-align:left;">
Sepal.Length:Petal.Length
</td>
<td style="text-align:right;">
0.87201
</td>
<td style="text-align:right;">
0.14964
</td>
<td style="text-align:right;">
12.8
</td>
</tr>
<tr>
<td style="text-align:left;">
Petal.Length:Petal.Width
</td>
<td style="text-align:right;">
0.99216
</td>
<td style="text-align:right;">
0.96898
</td>
<td style="text-align:right;">
0.8
</td>
</tr>
<tr>
<td style="text-align:left;">
Petal.Length:Species_setosa
</td>
<td style="text-align:right;">
0.98424
</td>
<td style="text-align:right;">
0.93217
</td>
<td style="text-align:right;">
1.6
</td>
</tr>
<tr>
<td style="text-align:left;">
Petal.Width:Species_versicolor
</td>
<td style="text-align:right;">
0.92066
</td>
<td style="text-align:right;">
0.60421
</td>
<td style="text-align:right;">
8.0
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>
<span class="co">## Uncentered model</span>
<span class="va">b2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sparseRBIC_bootstrap.html">sparseRBIC_bootstrap</a></span><span class="op">(</span><span class="va">rbic2</span>, B <span class="op">=</span> <span class="fl">250</span><span class="op">)</span></code></pre></div>
<table class="table table">
<thead><tr>
<th style="text-align:left;">
Coefficient
</th>
<th style="text-align:right;">
Mean_p
</th>
<th style="text-align:right;">
Gmean_p
</th>
<th style="text-align:right;">
% selected
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
(Intercept)
</td>
<td style="text-align:right;">
0.07601
</td>
<td style="text-align:right;">
0.00027
</td>
<td style="text-align:right;">
100.0
</td>
</tr>
<tr>
<td style="text-align:left;">
Species_setosa
</td>
<td style="text-align:right;">
0.08997
</td>
<td style="text-align:right;">
0.00001
</td>
<td style="text-align:right;">
100.0
</td>
</tr>
<tr>
<td style="text-align:left;">
Sepal.Length
</td>
<td style="text-align:right;">
0.00481
</td>
<td style="text-align:right;">
0.00000
</td>
<td style="text-align:right;">
100.0
</td>
</tr>
<tr>
<td style="text-align:left;">
Sepal.Length:Species_setosa
</td>
<td style="text-align:right;">
0.24837
</td>
<td style="text-align:right;">
0.00007
</td>
<td style="text-align:right;">
75.2
</td>
</tr>
<tr>
<td style="text-align:left;">
Petal.Width
</td>
<td style="text-align:right;">
0.34016
</td>
<td style="text-align:right;">
0.00006
</td>
<td style="text-align:right;">
66.4
</td>
</tr>
<tr>
<td style="text-align:left;">
Species_versicolor
</td>
<td style="text-align:right;">
0.58922
</td>
<td style="text-align:right;">
0.03208
</td>
<td style="text-align:right;">
42.4
</td>
</tr>
<tr>
<td style="text-align:left;">
Petal.Length
</td>
<td style="text-align:right;">
0.69109
</td>
<td style="text-align:right;">
0.19662
</td>
<td style="text-align:right;">
35.6
</td>
</tr>
<tr>
<td style="text-align:left;">
Species_virginica
</td>
<td style="text-align:right;">
0.97799
</td>
<td style="text-align:right;">
0.85138
</td>
<td style="text-align:right;">
2.4
</td>
</tr>
<tr>
<td style="text-align:left;">
Sepal.Length:Petal.Width
</td>
<td style="text-align:right;">
0.87231
</td>
<td style="text-align:right;">
0.22325
</td>
<td style="text-align:right;">
12.8
</td>
</tr>
<tr>
<td style="text-align:left;">
Sepal.Length:Species_virginica
</td>
<td style="text-align:right;">
0.99206
</td>
<td style="text-align:right;">
0.95350
</td>
<td style="text-align:right;">
0.8
</td>
</tr>
<tr>
<td style="text-align:left;">
Petal.Width:Species_setosa
</td>
<td style="text-align:right;">
0.91698
</td>
<td style="text-align:right;">
0.65775
</td>
<td style="text-align:right;">
8.4
</td>
</tr>
<tr>
<td style="text-align:left;">
Sepal.Length:Petal.Length
</td>
<td style="text-align:right;">
0.87201
</td>
<td style="text-align:right;">
0.14964
</td>
<td style="text-align:right;">
12.8
</td>
</tr>
<tr>
<td style="text-align:left;">
Petal.Length:Petal.Width
</td>
<td style="text-align:right;">
0.99216
</td>
<td style="text-align:right;">
0.96898
</td>
<td style="text-align:right;">
0.8
</td>
</tr>
<tr>
<td style="text-align:left;">
Petal.Length:Species_setosa
</td>
<td style="text-align:right;">
0.98424
</td>
<td style="text-align:right;">
0.93217
</td>
<td style="text-align:right;">
1.6
</td>
</tr>
<tr>
<td style="text-align:left;">
Petal.Width:Species_versicolor
</td>
<td style="text-align:right;">
0.91670
</td>
<td style="text-align:right;">
0.60281
</td>
<td style="text-align:right;">
8.4
</td>
</tr>
<tr>
<td style="text-align:left;">
Sepal.Length:Species_versicolor
</td>
<td style="text-align:right;">
0.97622
</td>
<td style="text-align:right;">
0.87766
</td>
<td style="text-align:right;">
2.4
</td>
</tr>
<tr>
<td style="text-align:left;">
Petal.Length:Species_virginica
</td>
<td style="text-align:right;">
0.99600
</td>
<td style="text-align:right;">
0.97059
</td>
<td style="text-align:right;">
0.4
</td>
</tr>
<tr>
<td style="text-align:left;">
Petal.Width:Species_virginica
</td>
<td style="text-align:right;">
0.99600
</td>
<td style="text-align:right;">
0.95986
</td>
<td style="text-align:right;">
0.4
</td>
</tr>
</tbody>
</table>
<p>This section is still under development.</p>
</div>
</div>
<div id="use-case-lung-data" class="section level1">
<h1 class="hasAnchor">
<a href="#use-case-lung-data" class="anchor"></a>Use case: lung data</h1>
<p>As a more realistic example, we take a data set that is often used to train models that can predict lung cancer status. It has 1027 observations and 14 covariates, including urban/rural, age, years of school, smoking years, number of children, etc.</p>
<p>First, let’s look at the data a little:</p>
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"irlcs_radon_syn"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">irlcs_radon_syn</span><span class="op">)</span></code></pre></div>
<pre><code>##        ID         CITY       YRSHOME          AGE        CASE    SCHOOL 
##  Min.   :   1.0   0:246   Min.   :20.0   Min.   :44.16   0:632   1: 92  
##  1st Qu.: 260.5   1:781   1st Qu.:25.0   1st Qu.:61.38   1:395   2:506  
##  Median : 492.0           Median :31.0   Median :67.84           3:293  
##  Mean   : 505.2           Mean   :33.1   Mean   :67.45           4:106  
##  3rd Qu.: 761.0           3rd Qu.:39.0   3rd Qu.:73.82           5: 30  
##  Max.   :1026.0           Max.   :75.0   Max.   :84.80                  
##                                                                         
##      SMKYRS         CHILDREN           PYR            PYRRATE       
##  Min.   : 0.00   Min.   : 0.000   Min.   :  0.00   Min.   :0.00000  
##  1st Qu.: 0.00   1st Qu.: 2.000   1st Qu.:  0.00   1st Qu.:0.00000  
##  Median :13.00   Median : 3.000   Median :  3.60   Median :0.05368  
##  Mean   :20.58   Mean   : 3.065   Mean   : 19.31   Mean   :0.31745  
##  3rd Qu.:41.00   3rd Qu.: 4.000   3rd Qu.: 35.07   3rd Qu.:0.58024  
##  Max.   :64.00   Max.   :13.000   Max.   :138.45   Max.   :2.55702  
##                                                                     
##     SMKQUIT            BMI            WLM20        PRELUNG SMKEVER SMKCUR 
##  Min.   : 0.000   Min.   :16.64   Min.   : 2.176   0:692   0:476   0:705  
##  1st Qu.: 0.000   1st Qu.:21.79   1st Qu.: 5.902   1:335   1:551   1:322  
##  Median : 0.000   Median :23.78   Median : 8.683                          
##  Mean   : 4.733   Mean   :24.60   Mean   :10.914                          
##  3rd Qu.: 3.325   3rd Qu.:27.40   3rd Qu.:13.246                          
##  Max.   :57.355   Max.   :41.60   Max.   :77.457                          
##                   NA's   :51</code></pre>
<p>Note:</p>
<ul>
<li>There are missing values for BMI - we will see how <code>sparseR</code> handles this.</li>
<li>Everything is coded as numeric except the outcome, case (this is not necessary for <code>sparseR</code> to work), as we will see.</li>
<li>
<code>ID</code> is an arbitrary identifying variable which should not be used in the modeling phase</li>
</ul>
<div class="sourceCode" id="cb64"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">irlcs_radon_syn</span> <span class="op">&lt;-</span> <span class="fu">select</span><span class="op">(</span><span class="va">irlcs_radon_syn</span>, <span class="op">-</span><span class="va">ID</span><span class="op">)</span></code></pre></div>
<p>At this point, we will split the data into a test and training set.</p>
<div class="sourceCode" id="cb65"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">13</span><span class="op">)</span>

<span class="va">N</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">irlcs_radon_syn</span><span class="op">)</span>
<span class="va">trainIDX</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">N</span>, <span class="va">N</span> <span class="op">*</span> <span class="fl">.75</span><span class="op">)</span>
<span class="va">train</span> <span class="op">&lt;-</span> <span class="va">irlcs_radon_syn</span><span class="op">[</span><span class="va">trainIDX</span>,<span class="op">]</span>
<span class="va">test</span> <span class="op">&lt;-</span> <span class="va">irlcs_radon_syn</span><span class="op">[</span><span class="op">-</span><span class="va">trainIDX</span>,<span class="op">]</span></code></pre></div>
<div id="preprocessing" class="section level2">
<h2 class="hasAnchor">
<a href="#preprocessing" class="anchor"></a>Preprocessing</h2>
<p>Although the <code><a href="../reference/sparseR.html">sparseR()</a></code> function will do it automatically, it’s generally a good idea to see how the data is being preprocessed and to examine how the model matrix is built before the regularization. We can see what <code>sparseR</code> does to preprocess the data by running the function <code>sparseR_prep</code>, which utilizes the <code>recipes</code> package to perform preprocessing. At no time is the outcome used to train any of the steps, except for the elimination of NA values if any exist.</p>
<div class="sourceCode" id="cb66"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">prep_obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sparseR_prep.html">sparseR_prep</a></span><span class="op">(</span><span class="va">CASE</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">train</span>, k <span class="op">=</span> <span class="fl">0</span>, poly <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>
<span class="va">prep_obj</span></code></pre></div>
<pre><code>## Data Recipe
## 
## Inputs:
## 
##       role #variables
##      dummy          4
##    outcome          1
##  predictor         10
## 
## Training data contained 770 data points and 43 incomplete rows. 
## 
## Operations:
## 
## Sparse, unbalanced variable filter removed no terms [trained]
## Centering to mean for YRSHOME, AGE, SMKYRS, CHILDREN, PYR, ... [trained]
## Scaling for YRSHOME, AGE, SMKYRS, CHILDREN, PYR, ... [trained]
## Collapsing factor levels for SCHOOL [trained]
## K-nearest neighbor imputation for AGE, SCHOOL, SMKYRS, CHILDREN, PYR, ... [trained]
## Removing rows with NA values in everything()
## Variables removed CASE [trained]
## Dummy variables from CITY, SCHOOL, PRELUNG, SMKEVER, SMKCUR [trained]
## Sparse, unbalanced variable filter removed SCHOOL_other [trained]</code></pre>
<p>We see that the preprocessor did many things, among which it imputed the data for the missing value using the other predictors in the model. Apparently, by default, this preprocessor will remove variables with “near” zero variance, and that as a result, SMKYRS is not considered (it’s eliminated in an early step).</p>
<p>If we look at this variable, we see that it may be informative:</p>
<div class="sourceCode" id="cb68"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">MASS</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/MASS/man/truehist.html">truehist</a></span><span class="op">(</span><span class="va">train</span><span class="op">$</span><span class="va">SMKYRS</span><span class="op">)</span></code></pre></div>
<p><img src="sparseR_files/figure-html/unnamed-chunk-35-1.png" width="672"></p>
<p>Therefore, we can tell the preprocessor not to filter this variable in two ways. First, we could tell it to use <code>zv</code> instead of <code>nzv</code>, in which case it will only remove zero variance predictors:</p>
<div class="sourceCode" id="cb69"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/sparseR_prep.html">sparseR_prep</a></span><span class="op">(</span><span class="va">CASE</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">train</span>, k <span class="op">=</span> <span class="fl">0</span>, poly <span class="op">=</span> <span class="fl">1</span>, filter <span class="op">=</span> <span class="st">"zv"</span><span class="op">)</span></code></pre></div>
<pre><code>## Data Recipe
## 
## Inputs:
## 
##       role #variables
##      dummy          4
##    outcome          1
##  predictor         10
## 
## Training data contained 770 data points and 43 incomplete rows. 
## 
## Operations:
## 
## Zero variance filter removed no terms [trained]
## Centering to mean for YRSHOME, AGE, SMKYRS, CHILDREN, PYR, ... [trained]
## Scaling for YRSHOME, AGE, SMKYRS, CHILDREN, PYR, ... [trained]
## Collapsing factor levels for SCHOOL [trained]
## K-nearest neighbor imputation for AGE, SCHOOL, SMKYRS, CHILDREN, PYR, ... [trained]
## Removing rows with NA values in everything()
## Variables removed CASE [trained]
## Dummy variables from CITY, SCHOOL, PRELUNG, SMKEVER, SMKCUR [trained]
## Zero variance filter removed no terms [trained]</code></pre>
<p>Or, we could adjust the options for the near-zero variance filter (see <code><a href="https://recipes.tidymodels.org/reference/step_nzv.html">?recipes::step_nzv</a></code> for details):</p>
<div class="sourceCode" id="cb71"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/sparseR_prep.html">sparseR_prep</a></span><span class="op">(</span><span class="va">CASE</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">train</span>, k <span class="op">=</span> <span class="fl">0</span>, poly <span class="op">=</span> <span class="fl">1</span>, extra_opts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>unique_cut <span class="op">=</span> <span class="fl">5</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## Data Recipe
## 
## Inputs:
## 
##       role #variables
##      dummy          4
##    outcome          1
##  predictor         10
## 
## Training data contained 770 data points and 43 incomplete rows. 
## 
## Operations:
## 
## Sparse, unbalanced variable filter removed no terms [trained]
## Centering to mean for YRSHOME, AGE, SMKYRS, CHILDREN, PYR, ... [trained]
## Scaling for YRSHOME, AGE, SMKYRS, CHILDREN, PYR, ... [trained]
## Collapsing factor levels for SCHOOL [trained]
## K-nearest neighbor imputation for AGE, SCHOOL, SMKYRS, CHILDREN, PYR, ... [trained]
## Removing rows with NA values in everything()
## Variables removed CASE [trained]
## Dummy variables from CITY, SCHOOL, PRELUNG, SMKEVER, SMKCUR [trained]
## Sparse, unbalanced variable filter removed SCHOOL_other [trained]</code></pre>
<p>Notice that we haven’t told the preprocessor to build any interactions or polynomials of higher degree than 1. we can do this simply by setting <code>k</code> and <code>poly</code> respectively to higher numbers:</p>
<div class="sourceCode" id="cb73"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/sparseR_prep.html">sparseR_prep</a></span><span class="op">(</span><span class="va">CASE</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">train</span>, k <span class="op">=</span> <span class="fl">1</span>, poly <span class="op">=</span> <span class="fl">1</span>, extra_opts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>unique_cut <span class="op">=</span> <span class="fl">5</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## Data Recipe
## 
## Inputs:
## 
##       role #variables
##      dummy          4
##    outcome          1
##  predictor         10
## 
## Training data contained 770 data points and 43 incomplete rows. 
## 
## Operations:
## 
## Sparse, unbalanced variable filter removed no terms [trained]
## Centering to mean for YRSHOME, AGE, SMKYRS, CHILDREN, PYR, ... [trained]
## Scaling for YRSHOME, AGE, SMKYRS, CHILDREN, PYR, ... [trained]
## Collapsing factor levels for SCHOOL [trained]
## K-nearest neighbor imputation for AGE, SCHOOL, SMKYRS, CHILDREN, PYR, ... [trained]
## Removing rows with NA values in everything()
## Variables removed CASE [trained]
## Dummy variables from CITY, SCHOOL, PRELUNG, SMKEVER, SMKCUR [trained]
## Interactions with (YRSHOME + AGE + SMKYRS + CHILDREN + PYR + PYRRATE + SMKQUIT + BMI + WLM20 + (CITY_X0 + CITY_X1 + SCHOOL_X1 + SCHOOL_X2 + SCHOOL_X3 + SCHOOL_X4 + SCHOOL_other + PRELUNG_X0 + PRELUNG_X1 + SMKEVER_X0 + SMKEVER_X1 + SMKCUR_X0 + SMKCUR_X1)) * (YRSHOME + AGE + SMKYRS + CHILDREN + PYR + PYRRATE + SMKQUIT + BMI + WLM20 + (CITY_X0 + CITY_X1 + SCHOOL_X1 + SCHOOL_X2 + SCHOOL_X3 + SCHOOL_X4 + SCHOOL_other + PRELUNG_X0 + PRELUNG_X1 + SMKEVER_X0 + SMKEVER_X1 + SMKCUR_X0 + SMKCUR_X1)) [trained]
## Sparse, unbalanced variable filter removed SCHOOL_other, ... [trained]</code></pre>
<div class="sourceCode" id="cb75"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/sparseR_prep.html">sparseR_prep</a></span><span class="op">(</span><span class="va">CASE</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">train</span>, k <span class="op">=</span> <span class="fl">1</span>, poly <span class="op">=</span> <span class="fl">2</span>, extra_opts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>unique_cut <span class="op">=</span> <span class="fl">5</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## Data Recipe
## 
## Inputs:
## 
##       role #variables
##      dummy          4
##    outcome          1
##  predictor         10
## 
## Training data contained 770 data points and 43 incomplete rows. 
## 
## Operations:
## 
## Sparse, unbalanced variable filter removed no terms [trained]
## Centering to mean for YRSHOME, AGE, SMKYRS, CHILDREN, PYR, ... [trained]
## Scaling for YRSHOME, AGE, SMKYRS, CHILDREN, PYR, ... [trained]
## Collapsing factor levels for SCHOOL [trained]
## K-nearest neighbor imputation for AGE, SCHOOL, SMKYRS, CHILDREN, PYR, ... [trained]
## Removing rows with NA values in everything()
## Variables removed CASE [trained]
## Dummy variables from CITY, SCHOOL, PRELUNG, SMKEVER, SMKCUR [trained]
## Interactions with (YRSHOME + AGE + SMKYRS + CHILDREN + PYR + PYRRATE + SMKQUIT + BMI + WLM20 + (CITY_X0 + CITY_X1 + SCHOOL_X1 + SCHOOL_X2 + SCHOOL_X3 + SCHOOL_X4 + SCHOOL_other + PRELUNG_X0 + PRELUNG_X1 + SMKEVER_X0 + SMKEVER_X1 + SMKCUR_X0 + SMKCUR_X1)) * (YRSHOME + AGE + SMKYRS + CHILDREN + PYR + PYRRATE + SMKQUIT + BMI + WLM20 + (CITY_X0 + CITY_X1 + SCHOOL_X1 + SCHOOL_X2 + SCHOOL_X3 + SCHOOL_X4 + SCHOOL_other + PRELUNG_X0 + PRELUNG_X1 + SMKEVER_X0 + SMKEVER_X1 + SMKCUR_X0 + SMKCUR_X1)) [trained]
## Orthogonal polynomials on YRSHOME, AGE, SMKYRS, CHILDREN, ... [trained]
## Sparse, unbalanced variable filter removed SCHOOL_other, ... [trained]</code></pre>
<p><em>Note</em>: This preprocessor does not actually produce any data, it only prepares all of the steps. In the recipes package, this is known as <code>prep</code>ping the processor. the final step is called <code>bake</code>, where the data is fed through the processor and a new data set is returned.</p>
</div>
<div id="using-the-sparser-function" class="section level2">
<h2 class="hasAnchor">
<a href="#using-the-sparser-function" class="anchor"></a>Using the <code>sparseR</code> function</h2>
<p>All of the preprocessing options can be accomplished through the main function for the package, <code>sparseR</code>. The following code runs a SRL model, an APL model, a main effects model, and an SRL with polynomials:</p>
<div class="sourceCode" id="cb77"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">lso</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
  SRL  <span class="op">=</span> <span class="fu"><a href="../reference/sparseR.html">sparseR</a></span><span class="op">(</span><span class="va">CASE</span> <span class="op">~</span> <span class="va">.</span>, <span class="va">train</span>, seed <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,            <span class="co">## SRL model</span>
  APL  <span class="op">=</span> <span class="fu"><a href="../reference/sparseR.html">sparseR</a></span><span class="op">(</span><span class="va">CASE</span> <span class="op">~</span> <span class="va">.</span>, <span class="va">train</span>, seed <span class="op">=</span> <span class="fl">1</span>, gamma <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>, <span class="co">## APL model</span>
  ME   <span class="op">=</span> <span class="fu"><a href="../reference/sparseR.html">sparseR</a></span><span class="op">(</span><span class="va">CASE</span> <span class="op">~</span> <span class="va">.</span>, <span class="va">train</span>, seed <span class="op">=</span> <span class="fl">1</span>, k <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>,     <span class="co">## Main effects model</span>
  SRLp <span class="op">=</span> <span class="fu"><a href="../reference/sparseR.html">sparseR</a></span><span class="op">(</span><span class="va">CASE</span> <span class="op">~</span> <span class="va">.</span>, <span class="va">train</span>, seed <span class="op">=</span> <span class="fl">1</span>, poly <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>   <span class="co">## SRL + polynomials</span>
<span class="op">)</span></code></pre></div>
<p>The simple print method allows one to investigate all of these models</p>
<div class="sourceCode" id="cb78"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">lso</span></code></pre></div>
<pre><code>## $SRL
## 
## Model summary @ min CV:
## -----------------------------------------------------
##   lasso-penalized linear regression with n=770, p=195
##   (At lambda=0.0007):
##     Nonzero coefficients: 42
##     Cross-validation error (deviance): 0.14
##     R-squared: 0.43
##     Signal-to-noise ratio: 0.74
##     Scale estimate (sigma): 0.368
## 
##   SR information:
##              Vartype Total Selected Saturation Penalty
##          Main effect    21       10      0.476    4.58
##  Order 1 interaction   174       32      0.184   13.19
## 
## 
## Model summary @ CV1se:
## -----------------------------------------------------
##   lasso-penalized linear regression with n=770, p=195
##   (At lambda=0.0098):
##     Nonzero coefficients: 4
##     Cross-validation error (deviance): 0.14
##     R-squared: 0.40
##     Signal-to-noise ratio: 0.65
##     Scale estimate (sigma): 0.378
## 
##   SR information:
##              Vartype Total Selected Saturation Penalty
##          Main effect    21        4       0.19    4.58
##  Order 1 interaction   174        0       0.00   13.19
## 
## $APL
## 
## Model summary @ min CV:
## -----------------------------------------------------
##   lasso-penalized linear regression with n=770, p=195
##   (At lambda=0.0095):
##     Nonzero coefficients: 45
##     Cross-validation error (deviance): 0.14
##     R-squared: 0.42
##     Signal-to-noise ratio: 0.72
##     Scale estimate (sigma): 0.370
## 
##   SR information:
##              Vartype Total Selected Saturation Penalty
##          Main effect    21        5      0.238       1
##  Order 1 interaction   174       40      0.230       1
## 
## 
## Model summary @ CV1se:
## -----------------------------------------------------
##   lasso-penalized linear regression with n=770, p=195
##   (At lambda=0.0555):
##     Nonzero coefficients: 6
##     Cross-validation error (deviance): 0.14
##     R-squared: 0.39
##     Signal-to-noise ratio: 0.64
##     Scale estimate (sigma): 0.380
## 
##   SR information:
##              Vartype Total Selected Saturation Penalty
##          Main effect    21        3     0.1429       1
##  Order 1 interaction   174        3     0.0172       1
## 
## $ME
## 
## Model summary @ min CV:
## -----------------------------------------------------
##   lasso-penalized linear regression with n=770, p=21
##   (At lambda=0.0030):
##     Nonzero coefficients: 10
##     Cross-validation error (deviance): 0.14
##     R-squared: 0.41
##     Signal-to-noise ratio: 0.70
##     Scale estimate (sigma): 0.373
## 
##   SR information:
##      Vartype Total Selected Saturation Penalty
##  Main effect    21       10      0.476    4.58
## 
## 
## Model summary @ CV1se:
## -----------------------------------------------------
##   lasso-penalized linear regression with n=770, p=21
##   (At lambda=0.0158):
##     Nonzero coefficients: 3
##     Cross-validation error (deviance): 0.15
##     R-squared: 0.38
##     Signal-to-noise ratio: 0.61
##     Scale estimate (sigma): 0.383
## 
##   SR information:
##      Vartype Total Selected Saturation Penalty
##  Main effect    21        3      0.143    4.58
## 
## $SRLp
## 
## Model summary @ min CV:
## -----------------------------------------------------
##   lasso-penalized linear regression with n=770, p=204
##   (At lambda=0.0009):
##     Nonzero coefficients: 41
##     Cross-validation error (deviance): 0.13
##     R-squared: 0.43
##     Signal-to-noise ratio: 0.75
##     Scale estimate (sigma): 0.367
## 
##   SR information:
##              Vartype Total Selected Saturation Penalty
##          Main effect    21       11      0.524    4.58
##  Order 1 interaction   174       24      0.138   13.19
##   Order 2 polynomial     9        6      0.667    5.48
## 
## 
## Model summary @ CV1se:
## -----------------------------------------------------
##   lasso-penalized linear regression with n=770, p=204
##   (At lambda=0.0093):
##     Nonzero coefficients: 4
##     Cross-validation error (deviance): 0.14
##     R-squared: 0.40
##     Signal-to-noise ratio: 0.66
##     Scale estimate (sigma): 0.377
## 
##   SR information:
##              Vartype Total Selected Saturation Penalty
##          Main effect    21        3      0.143    4.58
##  Order 1 interaction   174        0      0.000   13.19
##   Order 2 polynomial     9        1      0.111    5.48</code></pre>
<p>Similarly, plots can be produced of all of these figures:</p>
<div class="sourceCode" id="cb80"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">2</span><span class="op">)</span>, mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">4</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span>
<span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">lso</span>, <span class="va">plot</span>, log.l <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></code></pre></div>
<p><img src="sparseR_files/figure-html/unnamed-chunk-41-1.png" width="672"></p>
<p>MCP:</p>
<div class="sourceCode" id="cb81"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mcp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
  SRM  <span class="op">=</span> <span class="fu"><a href="../reference/sparseR.html">sparseR</a></span><span class="op">(</span><span class="va">CASE</span> <span class="op">~</span> <span class="va">.</span>, <span class="va">train</span>, seed <span class="op">=</span> <span class="fl">1</span>, penalty <span class="op">=</span> <span class="st">"MCP"</span><span class="op">)</span>,            <span class="co">## SRM model</span>
  APM  <span class="op">=</span> <span class="fu"><a href="../reference/sparseR.html">sparseR</a></span><span class="op">(</span><span class="va">CASE</span> <span class="op">~</span> <span class="va">.</span>, <span class="va">train</span>, seed <span class="op">=</span> <span class="fl">1</span>, gamma <span class="op">=</span> <span class="fl">0</span>, penalty <span class="op">=</span> <span class="st">"MCP"</span><span class="op">)</span>, <span class="co">## APM model</span>
  MEM   <span class="op">=</span> <span class="fu"><a href="../reference/sparseR.html">sparseR</a></span><span class="op">(</span><span class="va">CASE</span> <span class="op">~</span> <span class="va">.</span>, <span class="va">train</span>, seed <span class="op">=</span> <span class="fl">1</span>, k <span class="op">=</span> <span class="fl">0</span>, penalty <span class="op">=</span> <span class="st">"MCP"</span><span class="op">)</span>,     <span class="co">## Main effects MCP model</span>
  SRMp <span class="op">=</span> <span class="fu"><a href="../reference/sparseR.html">sparseR</a></span><span class="op">(</span><span class="va">CASE</span> <span class="op">~</span> <span class="va">.</span>, <span class="va">train</span>, seed <span class="op">=</span> <span class="fl">1</span>, poly <span class="op">=</span> <span class="fl">2</span>, penalty <span class="op">=</span> <span class="st">"MCP"</span><span class="op">)</span>   <span class="co">## SRM + polynomials</span>
<span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb82"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mcp</span></code></pre></div>
<pre><code>## $SRM
## 
## Model summary @ min CV:
## -----------------------------------------------------
##   MCP-penalized linear regression with n=770, p=195
##   (At lambda=0.0022):
##     Nonzero coefficients: 9
##     Cross-validation error (deviance): 0.14
##     R-squared: 0.42
##     Signal-to-noise ratio: 0.72
##     Scale estimate (sigma): 0.371
## 
##   SR information:
##              Vartype Total Selected Saturation Penalty
##          Main effect    21        7     0.3333    4.58
##  Order 1 interaction   174        2     0.0115   13.19
## 
## 
## Model summary @ CV1se:
## -----------------------------------------------------
##   MCP-penalized linear regression with n=770, p=195
##   (At lambda=0.0285):
##     Nonzero coefficients: 1
##     Cross-validation error (deviance): 0.14
##     R-squared: 0.39
##     Signal-to-noise ratio: 0.63
##     Scale estimate (sigma): 0.381
## 
##   SR information:
##              Vartype Total Selected Saturation Penalty
##          Main effect    21        1     0.0476    4.58
##  Order 1 interaction   174        0     0.0000   13.19
## 
## $APM
## 
## Model summary @ min CV:
## -----------------------------------------------------
##   MCP-penalized linear regression with n=770, p=195
##   (At lambda=0.0236):
##     Nonzero coefficients: 15
##     Cross-validation error (deviance): 0.14
##     R-squared: 0.41
##     Signal-to-noise ratio: 0.71
##     Scale estimate (sigma): 0.372
## 
##   SR information:
##              Vartype Total Selected Saturation Penalty
##          Main effect    21        3      0.143       1
##  Order 1 interaction   174       12      0.069       1
## 
## 
## Model summary @ CV1se:
## -----------------------------------------------------
##   MCP-penalized linear regression with n=770, p=195
##   (At lambda=0.1378):
##     Nonzero coefficients: 1
##     Cross-validation error (deviance): 0.15
##     R-squared: 0.38
##     Signal-to-noise ratio: 0.62
##     Scale estimate (sigma): 0.382
## 
##   SR information:
##              Vartype Total Selected Saturation Penalty
##          Main effect    21        1     0.0476       1
##  Order 1 interaction   174        0     0.0000       1
## 
## $MEM
## 
## Model summary @ min CV:
## -----------------------------------------------------
##   MCP-penalized linear regression with n=770, p=21
##   (At lambda=0.0044):
##     Nonzero coefficients: 5
##     Cross-validation error (deviance): 0.14
##     R-squared: 0.41
##     Signal-to-noise ratio: 0.70
##     Scale estimate (sigma): 0.373
## 
##   SR information:
##      Vartype Total Selected Saturation Penalty
##  Main effect    21        5      0.238    4.58
## 
## 
## Model summary @ CV1se:
## -----------------------------------------------------
##   MCP-penalized linear regression with n=770, p=21
##   (At lambda=0.0301):
##     Nonzero coefficients: 1
##     Cross-validation error (deviance): 0.15
##     R-squared: 0.38
##     Signal-to-noise ratio: 0.62
##     Scale estimate (sigma): 0.382
## 
##   SR information:
##      Vartype Total Selected Saturation Penalty
##  Main effect    21        1     0.0476    4.58
## 
## $SRMp
## 
## Model summary @ min CV:
## -----------------------------------------------------
##   MCP-penalized linear regression with n=770, p=204
##   (At lambda=0.0018):
##     Nonzero coefficients: 18
##     Cross-validation error (deviance): 0.14
##     R-squared: 0.42
##     Signal-to-noise ratio: 0.71
##     Scale estimate (sigma): 0.372
## 
##   SR information:
##              Vartype Total Selected Saturation Penalty
##          Main effect    21        5      0.238    4.58
##  Order 1 interaction   174        8      0.046   13.19
##   Order 2 polynomial     9        5      0.556    5.48
## 
## 
## Model summary @ CV1se:
## -----------------------------------------------------
##   MCP-penalized linear regression with n=770, p=204
##   (At lambda=0.0301):
##     Nonzero coefficients: 1
##     Cross-validation error (deviance): 0.15
##     R-squared: 0.38
##     Signal-to-noise ratio: 0.62
##     Scale estimate (sigma): 0.382
## 
##   SR information:
##              Vartype Total Selected Saturation Penalty
##          Main effect    21        1     0.0476    4.58
##  Order 1 interaction   174        0     0.0000   13.19
##   Order 2 polynomial     9        0     0.0000    5.48</code></pre>
<div class="sourceCode" id="cb84"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">2</span><span class="op">)</span>, mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">4</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span>
<span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">mcp</span>, <span class="va">plot</span>, log.l <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></code></pre></div>
<p><img src="sparseR_files/figure-html/unnamed-chunk-44-1.png" width="672"></p>
<p>SCAD:</p>
<div class="sourceCode" id="cb85"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">scad</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
  SRS  <span class="op">=</span> <span class="fu"><a href="../reference/sparseR.html">sparseR</a></span><span class="op">(</span><span class="va">CASE</span> <span class="op">~</span> <span class="va">.</span>, <span class="va">train</span>, seed <span class="op">=</span> <span class="fl">1</span>, penalty <span class="op">=</span> <span class="st">"SCAD"</span><span class="op">)</span>,            <span class="co">## SRS model</span>
  APS  <span class="op">=</span> <span class="fu"><a href="../reference/sparseR.html">sparseR</a></span><span class="op">(</span><span class="va">CASE</span> <span class="op">~</span> <span class="va">.</span>, <span class="va">train</span>, seed <span class="op">=</span> <span class="fl">1</span>, gamma <span class="op">=</span> <span class="fl">0</span>, penalty <span class="op">=</span> <span class="st">"SCAD"</span><span class="op">)</span>, <span class="co">## APS model</span>
  MES   <span class="op">=</span> <span class="fu"><a href="../reference/sparseR.html">sparseR</a></span><span class="op">(</span><span class="va">CASE</span> <span class="op">~</span> <span class="va">.</span>, <span class="va">train</span>, seed <span class="op">=</span> <span class="fl">1</span>, k <span class="op">=</span> <span class="fl">0</span>, penalty <span class="op">=</span> <span class="st">"SCAD"</span><span class="op">)</span>,    <span class="co">## Main effects SCAD model</span>
  SRSp <span class="op">=</span> <span class="fu"><a href="../reference/sparseR.html">sparseR</a></span><span class="op">(</span><span class="va">CASE</span> <span class="op">~</span> <span class="va">.</span>, <span class="va">train</span>, seed <span class="op">=</span> <span class="fl">1</span>, poly <span class="op">=</span> <span class="fl">2</span>, penalty <span class="op">=</span> <span class="st">"SCAD"</span><span class="op">)</span>   <span class="co">## SRS + polynomials</span>
<span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb86"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">scad</span></code></pre></div>
<pre><code>## $SRS
## 
## Model summary @ min CV:
## -----------------------------------------------------
##   SCAD-penalized linear regression with n=770, p=195
##   (At lambda=0.0017):
##     Nonzero coefficients: 20
##     Cross-validation error (deviance): 0.14
##     R-squared: 0.42
##     Signal-to-noise ratio: 0.72
##     Scale estimate (sigma): 0.371
## 
##   SR information:
##              Vartype Total Selected Saturation Penalty
##          Main effect    21        9     0.4286    4.58
##  Order 1 interaction   174       11     0.0632   13.19
## 
## 
## Model summary @ CV1se:
## -----------------------------------------------------
##   SCAD-penalized linear regression with n=770, p=195
##   (At lambda=0.0256):
##     Nonzero coefficients: 1
##     Cross-validation error (deviance): 0.15
##     R-squared: 0.39
##     Signal-to-noise ratio: 0.63
##     Scale estimate (sigma): 0.381
## 
##   SR information:
##              Vartype Total Selected Saturation Penalty
##          Main effect    21        1     0.0476    4.58
##  Order 1 interaction   174        0     0.0000   13.19
## 
## $APS
## 
## Model summary @ min CV:
## -----------------------------------------------------
##   SCAD-penalized linear regression with n=770, p=195
##   (At lambda=0.0201):
##     Nonzero coefficients: 21
##     Cross-validation error (deviance): 0.14
##     R-squared: 0.42
##     Signal-to-noise ratio: 0.71
##     Scale estimate (sigma): 0.372
## 
##   SR information:
##              Vartype Total Selected Saturation Penalty
##          Main effect    21        3      0.143       1
##  Order 1 interaction   174       18      0.103       1
## 
## 
## Model summary @ CV1se:
## -----------------------------------------------------
##   SCAD-penalized linear regression with n=770, p=195
##   (At lambda=0.1174):
##     Nonzero coefficients: 1
##     Cross-validation error (deviance): 0.15
##     R-squared: 0.39
##     Signal-to-noise ratio: 0.63
##     Scale estimate (sigma): 0.381
## 
##   SR information:
##              Vartype Total Selected Saturation Penalty
##          Main effect    21        1     0.0476       1
##  Order 1 interaction   174        0     0.0000       1
## 
## $MES
## 
## Model summary @ min CV:
## -----------------------------------------------------
##   SCAD-penalized linear regression with n=770, p=21
##   (At lambda=0.0035):
##     Nonzero coefficients: 7
##     Cross-validation error (deviance): 0.14
##     R-squared: 0.41
##     Signal-to-noise ratio: 0.70
##     Scale estimate (sigma): 0.373
## 
##   SR information:
##      Vartype Total Selected Saturation Penalty
##  Main effect    21        7      0.333    4.58
## 
## 
## Model summary @ CV1se:
## -----------------------------------------------------
##   SCAD-penalized linear regression with n=770, p=21
##   (At lambda=0.0256):
##     Nonzero coefficients: 1
##     Cross-validation error (deviance): 0.15
##     R-squared: 0.39
##     Signal-to-noise ratio: 0.63
##     Scale estimate (sigma): 0.381
## 
##   SR information:
##      Vartype Total Selected Saturation Penalty
##  Main effect    21        1     0.0476    4.58
## 
## $SRSp
## 
## Model summary @ min CV:
## -----------------------------------------------------
##   SCAD-penalized linear regression with n=770, p=204
##   (At lambda=0.0011):
##     Nonzero coefficients: 32
##     Cross-validation error (deviance): 0.14
##     R-squared: 0.42
##     Signal-to-noise ratio: 0.72
##     Scale estimate (sigma): 0.371
## 
##   SR information:
##              Vartype Total Selected Saturation Penalty
##          Main effect    21        6      0.286    4.58
##  Order 1 interaction   174       19      0.109   13.19
##   Order 2 polynomial     9        7      0.778    5.48
## 
## 
## Model summary @ CV1se:
## -----------------------------------------------------
##   SCAD-penalized linear regression with n=770, p=204
##   (At lambda=0.0256):
##     Nonzero coefficients: 1
##     Cross-validation error (deviance): 0.15
##     R-squared: 0.39
##     Signal-to-noise ratio: 0.63
##     Scale estimate (sigma): 0.381
## 
##   SR information:
##              Vartype Total Selected Saturation Penalty
##          Main effect    21        1     0.0476    4.58
##  Order 1 interaction   174        0     0.0000   13.19
##   Order 2 polynomial     9        0     0.0000    5.48</code></pre>
<div class="sourceCode" id="cb88"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">2</span><span class="op">)</span>, mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">4</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span>
<span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">mcp</span>, <span class="va">plot</span>, log.l <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></code></pre></div>
<p><img src="sparseR_files/figure-html/unnamed-chunk-47-1.png" width="672"></p>
<p>Summary:</p>
<div class="sourceCode" id="cb89"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">lso_sum</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">lso</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu">bind_cols</span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">results_summary</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">5</span>,<span class="fl">2</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span><span class="op">]</span>,<span class="va">x</span><span class="op">$</span><span class="va">results1se_summary</span><span class="op">[</span>,<span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, <span class="fl">5</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">bind_rows</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code>## New names:
## * Selected -&gt; Selected...4
## * Saturation -&gt; Saturation...5
## * Selected -&gt; Selected...6
## * Saturation -&gt; Saturation...7
## New names:
## * Selected -&gt; Selected...4
## * Saturation -&gt; Saturation...5
## * Selected -&gt; Selected...6
## * Saturation -&gt; Saturation...7
## New names:
## * Selected -&gt; Selected...4
## * Saturation -&gt; Saturation...5
## * Selected -&gt; Selected...6
## * Saturation -&gt; Saturation...7
## New names:
## * Selected -&gt; Selected...4
## * Saturation -&gt; Saturation...5
## * Selected -&gt; Selected...6
## * Saturation -&gt; Saturation...7</code></pre>
<div class="sourceCode" id="cb91"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mcp_sum</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">mcp</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu">bind_cols</span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">results_summary</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">5</span>,<span class="fl">2</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span><span class="op">]</span>,<span class="va">x</span><span class="op">$</span><span class="va">results1se_summary</span><span class="op">[</span>,<span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, <span class="fl">5</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">bind_rows</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code>## New names:
## * Selected -&gt; Selected...4
## * Saturation -&gt; Saturation...5
## * Selected -&gt; Selected...6
## * Saturation -&gt; Saturation...7
## New names:
## * Selected -&gt; Selected...4
## * Saturation -&gt; Saturation...5
## * Selected -&gt; Selected...6
## * Saturation -&gt; Saturation...7
## New names:
## * Selected -&gt; Selected...4
## * Saturation -&gt; Saturation...5
## * Selected -&gt; Selected...6
## * Saturation -&gt; Saturation...7
## New names:
## * Selected -&gt; Selected...4
## * Saturation -&gt; Saturation...5
## * Selected -&gt; Selected...6
## * Saturation -&gt; Saturation...7</code></pre>
<div class="sourceCode" id="cb93"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">scad_sum</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">scad</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu">bind_cols</span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">results_summary</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">5</span>,<span class="fl">2</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span><span class="op">]</span>,<span class="va">x</span><span class="op">$</span><span class="va">results1se_summary</span><span class="op">[</span>,<span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, <span class="fl">5</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">bind_rows</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code>## New names:
## * Selected -&gt; Selected...4
## * Saturation -&gt; Saturation...5
## * Selected -&gt; Selected...6
## * Saturation -&gt; Saturation...7
## New names:
## * Selected -&gt; Selected...4
## * Saturation -&gt; Saturation...5
## * Selected -&gt; Selected...6
## * Saturation -&gt; Saturation...7
## New names:
## * Selected -&gt; Selected...4
## * Saturation -&gt; Saturation...5
## * Selected -&gt; Selected...6
## * Saturation -&gt; Saturation...7
## New names:
## * Selected -&gt; Selected...4
## * Saturation -&gt; Saturation...5
## * Selected -&gt; Selected...6
## * Saturation -&gt; Saturation...7</code></pre>
<table class="table table table-striped">
<thead>
<tr>
<th style="empty-cells: hide;border-bottom:hidden;" colspan="3">
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="2">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Min CV
</div>
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="2">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
CV1se
</div>
</th>
</tr>
<tr>
<th style="text-align:left;">
Vartype
</th>
<th style="text-align:right;">
Penalty
</th>
<th style="text-align:right;">
Total
</th>
<th style="text-align:right;">
Selected…4
</th>
<th style="text-align:right;">
Saturation…5
</th>
<th style="text-align:right;">
Selected…4
</th>
<th style="text-align:right;">
Saturation…5
</th>
</tr>
</thead>
<tbody>
<tr grouplength="2">
<td colspan="7" style="border-bottom: 1px solid;">
<strong>SRL</strong>
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
Main effect
</td>
<td style="text-align:right;">
4.583
</td>
<td style="text-align:right;">
21
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
0.476
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
0.190
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
Order 1 interaction
</td>
<td style="text-align:right;">
13.191
</td>
<td style="text-align:right;">
174
</td>
<td style="text-align:right;">
32
</td>
<td style="text-align:right;">
0.184
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.000
</td>
</tr>
<tr grouplength="2">
<td colspan="7" style="border-bottom: 1px solid;">
<strong>APL</strong>
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
Main effect
</td>
<td style="text-align:right;">
1.000
</td>
<td style="text-align:right;">
21
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
0.238
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0.143
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
Order 1 interaction
</td>
<td style="text-align:right;">
1.000
</td>
<td style="text-align:right;">
174
</td>
<td style="text-align:right;">
40
</td>
<td style="text-align:right;">
0.230
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0.017
</td>
</tr>
<tr grouplength="1">
<td colspan="7" style="border-bottom: 1px solid;">
<strong>MEL</strong>
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
Main effect
</td>
<td style="text-align:right;">
4.583
</td>
<td style="text-align:right;">
21
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
0.476
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0.143
</td>
</tr>
<tr grouplength="3">
<td colspan="7" style="border-bottom: 1px solid;">
<strong>SRLp</strong>
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
Main effect
</td>
<td style="text-align:right;">
4.583
</td>
<td style="text-align:right;">
21
</td>
<td style="text-align:right;">
11
</td>
<td style="text-align:right;">
0.524
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0.143
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
Order 1 interaction
</td>
<td style="text-align:right;">
13.191
</td>
<td style="text-align:right;">
174
</td>
<td style="text-align:right;">
24
</td>
<td style="text-align:right;">
0.138
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.000
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
Order 2 polynomial
</td>
<td style="text-align:right;">
5.477
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
0.667
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.111
</td>
</tr>
</tbody>
</table>
<table class="table table table-striped">
<thead>
<tr>
<th style="empty-cells: hide;border-bottom:hidden;" colspan="3">
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="2">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Min CV
</div>
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="2">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
CV1se
</div>
</th>
</tr>
<tr>
<th style="text-align:left;">
Vartype
</th>
<th style="text-align:right;">
Penalty
</th>
<th style="text-align:right;">
Total
</th>
<th style="text-align:right;">
Selected…4
</th>
<th style="text-align:right;">
Saturation…5
</th>
<th style="text-align:right;">
Selected…4
</th>
<th style="text-align:right;">
Saturation…5
</th>
</tr>
</thead>
<tbody>
<tr grouplength="2">
<td colspan="7" style="border-bottom: 1px solid;">
<strong>SRM</strong>
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
Main effect
</td>
<td style="text-align:right;">
4.583
</td>
<td style="text-align:right;">
21
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
0.333
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.048
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
Order 1 interaction
</td>
<td style="text-align:right;">
13.191
</td>
<td style="text-align:right;">
174
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0.011
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.000
</td>
</tr>
<tr grouplength="2">
<td colspan="7" style="border-bottom: 1px solid;">
<strong>APM</strong>
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
Main effect
</td>
<td style="text-align:right;">
1.000
</td>
<td style="text-align:right;">
21
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0.143
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.048
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
Order 1 interaction
</td>
<td style="text-align:right;">
1.000
</td>
<td style="text-align:right;">
174
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
0.069
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.000
</td>
</tr>
<tr grouplength="1">
<td colspan="7" style="border-bottom: 1px solid;">
<strong>MEM</strong>
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
Main effect
</td>
<td style="text-align:right;">
4.583
</td>
<td style="text-align:right;">
21
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
0.238
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.048
</td>
</tr>
<tr grouplength="3">
<td colspan="7" style="border-bottom: 1px solid;">
<strong>SRMp</strong>
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
Main effect
</td>
<td style="text-align:right;">
4.583
</td>
<td style="text-align:right;">
21
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
0.238
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.048
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
Order 1 interaction
</td>
<td style="text-align:right;">
13.191
</td>
<td style="text-align:right;">
174
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
0.046
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.000
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
Order 2 polynomial
</td>
<td style="text-align:right;">
5.477
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
0.556
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.000
</td>
</tr>
</tbody>
</table>
<table class="table table table-striped">
<thead>
<tr>
<th style="empty-cells: hide;border-bottom:hidden;" colspan="3">
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="2">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Min CV
</div>
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="2">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
CV1se
</div>
</th>
</tr>
<tr>
<th style="text-align:left;">
Vartype
</th>
<th style="text-align:right;">
Penalty
</th>
<th style="text-align:right;">
Total
</th>
<th style="text-align:right;">
Selected…4
</th>
<th style="text-align:right;">
Saturation…5
</th>
<th style="text-align:right;">
Selected…4
</th>
<th style="text-align:right;">
Saturation…5
</th>
</tr>
</thead>
<tbody>
<tr grouplength="2">
<td colspan="7" style="border-bottom: 1px solid;">
<strong>SRS</strong>
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
Main effect
</td>
<td style="text-align:right;">
4.583
</td>
<td style="text-align:right;">
21
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
0.429
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.048
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
Order 1 interaction
</td>
<td style="text-align:right;">
13.191
</td>
<td style="text-align:right;">
174
</td>
<td style="text-align:right;">
11
</td>
<td style="text-align:right;">
0.063
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.000
</td>
</tr>
<tr grouplength="2">
<td colspan="7" style="border-bottom: 1px solid;">
<strong>APS</strong>
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
Main effect
</td>
<td style="text-align:right;">
1.000
</td>
<td style="text-align:right;">
21
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0.143
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.048
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
Order 1 interaction
</td>
<td style="text-align:right;">
1.000
</td>
<td style="text-align:right;">
174
</td>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
0.103
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.000
</td>
</tr>
<tr grouplength="1">
<td colspan="7" style="border-bottom: 1px solid;">
<strong>MES</strong>
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
Main effect
</td>
<td style="text-align:right;">
4.583
</td>
<td style="text-align:right;">
21
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
0.333
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.048
</td>
</tr>
<tr grouplength="3">
<td colspan="7" style="border-bottom: 1px solid;">
<strong>SRSp</strong>
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
Main effect
</td>
<td style="text-align:right;">
4.583
</td>
<td style="text-align:right;">
21
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
0.286
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.048
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
Order 1 interaction
</td>
<td style="text-align:right;">
13.191
</td>
<td style="text-align:right;">
174
</td>
<td style="text-align:right;">
19
</td>
<td style="text-align:right;">
0.109
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.000
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
Order 2 polynomial
</td>
<td style="text-align:right;">
5.477
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
0.778
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.000
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="future-work" class="section level1">
<h1 class="hasAnchor">
<a href="#future-work" class="anchor"></a>Future work:</h1>
<p>This section is still incomplete and under active development.</p>
<div id="use-case-heart-data" class="section level2">
<h2 class="hasAnchor">
<a href="#use-case-heart-data" class="anchor"></a>Use case: heart data</h2>
<div class="sourceCode" id="cb95"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/rm.html">remove</a></span><span class="op">(</span>list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ls.html">ls</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>

<span class="co">## Load Data set, correctly code factors + outcome</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"Detrano"</span><span class="op">)</span>
<span class="va">cleveland</span><span class="op">$</span><span class="va">thal</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">cleveland</span><span class="op">$</span><span class="va">thal</span><span class="op">)</span>
<span class="va">cleveland</span><span class="op">$</span><span class="va">case</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">*</span><span class="op">(</span><span class="va">cleveland</span><span class="op">$</span><span class="va">num</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span>

<span class="co"># Convert variables into factor variables if necessary!</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">cleveland</span><span class="op">)</span></code></pre></div>
<pre><code>##       age             sex               cp           trestbps    
##  Min.   :29.00   Min.   :0.0000   Min.   :1.000   Min.   : 94.0  
##  1st Qu.:48.00   1st Qu.:0.0000   1st Qu.:3.000   1st Qu.:120.0  
##  Median :56.00   Median :1.0000   Median :3.000   Median :130.0  
##  Mean   :54.44   Mean   :0.6799   Mean   :3.158   Mean   :131.7  
##  3rd Qu.:61.00   3rd Qu.:1.0000   3rd Qu.:4.000   3rd Qu.:140.0  
##  Max.   :77.00   Max.   :1.0000   Max.   :4.000   Max.   :200.0  
##                                                                  
##       chol            fbs            restecg          thalach     
##  Min.   :126.0   Min.   :0.0000   Min.   :0.0000   Min.   : 71.0  
##  1st Qu.:211.0   1st Qu.:0.0000   1st Qu.:0.0000   1st Qu.:133.5  
##  Median :241.0   Median :0.0000   Median :1.0000   Median :153.0  
##  Mean   :246.7   Mean   :0.1485   Mean   :0.9901   Mean   :149.6  
##  3rd Qu.:275.0   3rd Qu.:0.0000   3rd Qu.:2.0000   3rd Qu.:166.0  
##  Max.   :564.0   Max.   :1.0000   Max.   :2.0000   Max.   :202.0  
##                                                                   
##      exang           oldpeak         slope             ca           thal    
##  Min.   :0.0000   Min.   :0.00   Min.   :1.000   Min.   :0.0000   3   :166  
##  1st Qu.:0.0000   1st Qu.:0.00   1st Qu.:1.000   1st Qu.:0.0000   6   : 18  
##  Median :0.0000   Median :0.80   Median :2.000   Median :0.0000   7   :117  
##  Mean   :0.3267   Mean   :1.04   Mean   :1.601   Mean   :0.6722   NA's:  2  
##  3rd Qu.:1.0000   3rd Qu.:1.60   3rd Qu.:2.000   3rd Qu.:1.0000             
##  Max.   :1.0000   Max.   :6.20   Max.   :3.000   Max.   :3.0000             
##                                                  NA's   :4                  
##       num              case       
##  Min.   :0.0000   Min.   :0.0000  
##  1st Qu.:0.0000   1st Qu.:0.0000  
##  Median :0.0000   Median :0.0000  
##  Mean   :0.9373   Mean   :0.4587  
##  3rd Qu.:2.0000   3rd Qu.:1.0000  
##  Max.   :4.0000   Max.   :1.0000  
## </code></pre>
<div class="sourceCode" id="cb97"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">cleveland</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>##      age      sex       cp trestbps     chol      fbs  restecg  thalach 
##       41        2        4       50      152        2        3       91 
##    exang  oldpeak    slope       ca     thal      num     case 
##        2       40        3        5        4        5        2</code></pre>
<div class="sourceCode" id="cb99"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">cleveland</span><span class="op">$</span><span class="va">sex</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">cleveland</span><span class="op">$</span><span class="va">sex</span><span class="op">)</span>
<span class="va">cleveland</span><span class="op">$</span><span class="va">fbs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">cleveland</span><span class="op">$</span><span class="va">fbs</span><span class="op">)</span>
<span class="va">cleveland</span><span class="op">$</span><span class="va">exang</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">cleveland</span><span class="op">$</span><span class="va">exang</span><span class="op">)</span>

<span class="co"># Set seed for reproducibility</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">167</span><span class="op">)</span>

<span class="co"># Split data into test and train</span>
<span class="va">N</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">cleveland</span><span class="op">)</span>
<span class="va">trainIDX</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">N</span>, <span class="va">N</span><span class="op">*</span><span class="fl">.5</span><span class="op">)</span>
<span class="va">trainDF</span> <span class="op">&lt;-</span> <span class="va">cleveland</span><span class="op">[</span><span class="va">trainIDX</span>,<span class="op">]</span> <span class="op">%&gt;%</span>
  <span class="fu">select</span><span class="op">(</span><span class="op">-</span><span class="va">num</span><span class="op">)</span>
<span class="va">testDF</span> <span class="op">&lt;-</span> <span class="va">cleveland</span><span class="op">[</span><span class="op">-</span><span class="va">trainIDX</span>,<span class="op">]</span> <span class="op">%&gt;%</span>
  <span class="fu">select</span><span class="op">(</span><span class="op">-</span><span class="va">num</span><span class="op">)</span>

<span class="co"># Simulate missing data</span>
<span class="va">trainDF</span><span class="op">$</span><span class="va">thal</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">trainDF</span><span class="op">$</span><span class="va">thalach</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span>

<span class="va">lso</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
  SRL  <span class="op">=</span> <span class="fu"><a href="../reference/sparseR.html">sparseR</a></span><span class="op">(</span><span class="va">case</span> <span class="op">~</span> <span class="va">.</span>, <span class="va">trainDF</span>, seed <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>, <span class="co">## SRL model</span>
  APL  <span class="op">=</span> <span class="fu"><a href="../reference/sparseR.html">sparseR</a></span><span class="op">(</span><span class="va">case</span> <span class="op">~</span> <span class="va">.</span>, <span class="va">trainDF</span>, seed <span class="op">=</span> <span class="fl">1</span>, gamma <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>, <span class="co">## APL model</span>
  ME   <span class="op">=</span> <span class="fu"><a href="../reference/sparseR.html">sparseR</a></span><span class="op">(</span><span class="va">case</span> <span class="op">~</span> <span class="va">.</span>, <span class="va">trainDF</span>, seed <span class="op">=</span> <span class="fl">1</span>, k <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>, <span class="co">## Main effects model</span>
  SRLp <span class="op">=</span> <span class="fu"><a href="../reference/sparseR.html">sparseR</a></span><span class="op">(</span><span class="va">case</span> <span class="op">~</span> <span class="va">.</span>, <span class="va">trainDF</span>, seed <span class="op">=</span> <span class="fl">1</span>, poly <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="co">## SRL + polynomials</span>
<span class="op">)</span>

<span class="va">lso</span></code></pre></div>
<pre><code>## $SRL
## 
## Model summary @ min CV:
## -----------------------------------------------------
##   lasso-penalized linear regression with n=151, p=153
##   (At lambda=0.0070):
##     Nonzero coefficients: 12
##     Cross-validation error (deviance): 0.13
##     R-squared: 0.48
##     Signal-to-noise ratio: 0.93
##     Scale estimate (sigma): 0.357
## 
##   SR information:
##              Vartype Total Selected Saturation Penalty
##          Main effect    18       12      0.667    4.24
##  Order 1 interaction   135        0      0.000   11.62
## 
## 
## Model summary @ CV1se:
## -----------------------------------------------------
##   lasso-penalized linear regression with n=151, p=153
##   (At lambda=0.0204):
##     Nonzero coefficients: 7
##     Cross-validation error (deviance): 0.14
##     R-squared: 0.42
##     Signal-to-noise ratio: 0.73
##     Scale estimate (sigma): 0.377
## 
##   SR information:
##              Vartype Total Selected Saturation Penalty
##          Main effect    18        7      0.389    4.24
##  Order 1 interaction   135        0      0.000   11.62
## 
## $APL
## 
## Model summary @ min CV:
## -----------------------------------------------------
##   lasso-penalized linear regression with n=151, p=153
##   (At lambda=0.0635):
##     Nonzero coefficients: 15
##     Cross-validation error (deviance): 0.14
##     R-squared: 0.43
##     Signal-to-noise ratio: 0.75
##     Scale estimate (sigma): 0.375
## 
##   SR information:
##              Vartype Total Selected Saturation Penalty
##          Main effect    18        6     0.3333       1
##  Order 1 interaction   135        9     0.0667       1
## 
## 
## Model summary @ CV1se:
## -----------------------------------------------------
##   lasso-penalized linear regression with n=151, p=153
##   (At lambda=0.1144):
##     Nonzero coefficients: 9
##     Cross-validation error (deviance): 0.15
##     R-squared: 0.37
##     Signal-to-noise ratio: 0.59
##     Scale estimate (sigma): 0.393
## 
##   SR information:
##              Vartype Total Selected Saturation Penalty
##          Main effect    18        5     0.2778       1
##  Order 1 interaction   135        4     0.0296       1
## 
## $ME
## 
## Model summary @ min CV:
## -----------------------------------------------------
##   lasso-penalized linear regression with n=151, p=18
##   (At lambda=0.0033):
##     Nonzero coefficients: 13
##     Cross-validation error (deviance): 0.13
##     R-squared: 0.49
##     Signal-to-noise ratio: 0.96
##     Scale estimate (sigma): 0.354
## 
##   SR information:
##      Vartype Total Selected Saturation Penalty
##  Main effect    18       13      0.722    4.24
## 
## 
## Model summary @ CV1se:
## -----------------------------------------------------
##   lasso-penalized linear regression with n=151, p=18
##   (At lambda=0.0193):
##     Nonzero coefficients: 7
##     Cross-validation error (deviance): 0.14
##     R-squared: 0.43
##     Signal-to-noise ratio: 0.75
##     Scale estimate (sigma): 0.375
## 
##   SR information:
##      Vartype Total Selected Saturation Penalty
##  Main effect    18        7      0.389    4.24
## 
## $SRLp
## 
## Model summary @ min CV:
## -----------------------------------------------------
##   lasso-penalized linear regression with n=151, p=162
##   (At lambda=0.0033):
##     Nonzero coefficients: 24
##     Cross-validation error (deviance): 0.12
##     R-squared: 0.51
##     Signal-to-noise ratio: 1.04
##     Scale estimate (sigma): 0.348
## 
##   SR information:
##              Vartype Total Selected Saturation Penalty
##          Main effect    18       14     0.7778    4.24
##  Order 1 interaction   135        7     0.0519   11.62
##   Order 2 polynomial     9        3     0.3333    5.20
## 
## 
## Model summary @ CV1se:
## -----------------------------------------------------
##   lasso-penalized linear regression with n=151, p=162
##   (At lambda=0.0156):
##     Nonzero coefficients: 8
##     Cross-validation error (deviance): 0.14
##     R-squared: 0.45
##     Signal-to-noise ratio: 0.82
##     Scale estimate (sigma): 0.368
## 
##   SR information:
##              Vartype Total Selected Saturation Penalty
##          Main effect    18        8      0.444    4.24
##  Order 1 interaction   135        0      0.000   11.62
##   Order 2 polynomial     9        0      0.000    5.20</code></pre>
<div class="sourceCode" id="cb101"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">lso</span><span class="op">$</span><span class="va">SRL</span><span class="op">)</span></code></pre></div>
<p><img src="sparseR_files/figure-html/unnamed-chunk-50-1.png" width="672"><img src="sparseR_files/figure-html/unnamed-chunk-50-2.png" width="672"></p>
<div class="sourceCode" id="cb102"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">lso</span>, <span class="va">plot</span>, log.l <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></code></pre></div>
<p><img src="sparseR_files/figure-html/unnamed-chunk-50-3.png" width="672"></p>
<pre><code>## $SRL
## NULL
## 
## $APL
## NULL
## 
## $ME
## NULL
## 
## $SRLp
## NULL</code></pre>
</div>
<div id="use-case-sheddon-survival-data" class="section level2">
<h2 class="hasAnchor">
<a href="#use-case-sheddon-survival-data" class="anchor"></a>Use case: Sheddon survival data</h2>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Ryan Andrew Peterson.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
